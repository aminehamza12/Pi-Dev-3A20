if (self.CavalryLogger) { CavalryLogger.start_js(["49+AK"]); }

__d("IrisProtocolMessageLifetime",[],(function(a,b,c,d,e,f){e.exports={TTL_OFF:0,TTL_ON_UNKNOWN:1,TTL_30SECONDS:3e4,TTL_1MINUTE:6e4,TTL_3MINUTES:18e4,TTL_5MINUTES:3e5,TTL_10MINUTES:6e5,TTL_15MINUTES:9e5,TTL_30MINUTES:18e5,TTL_1HOUR:36e5,TTL_2HOURS:72e5,TTL_4HOURS:144e5,TTL_8HOURS:288e5,TTL_12HOURS:432e5,TTL_24HOURS:864e5}}),null);
__d("MessageLiveLocationClientSyncProtocolStopReason",[],(function(a,b,c,d,e,f){e.exports={EXPIRED:1,CANCELED:2,ARRIVED:3}}),null);
__d("BonfireFeatureGating",["gkx"],(function(a,b,c,d,e,f){"use strict";a={canReceiveBonfireRingInterop:function(){return b("gkx")("AT67-yEeEisuZnuRf9ZZfe8uDaUmU0f8iOgZ8XTHAvRp7_a_JJm4LDabRivTtsii-tCqADjQbwZjHRWhjygfaDJN")}};e.exports=a}),null);
__d("MercurySyncHolesTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:MercurySyncHolesLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:MercurySyncHolesLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:MercurySyncHolesLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setDifference=function(a){this.$1.difference=a;return this};a.prototype.setSeqID=function(a){this.$1.seq_id=a;return this};a.prototype.setTopicType=function(a){this.$1.topic_type=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};c={difference:!0,seq_id:!0,topic_type:!0,vc:!0};e.exports=a}),null);
__d("ChatActivity",["Arbiter","Event","JSLogger","MercuryConfig","PresenceState","UserActivity"],(function(a,b,c,d,e,f){__p&&__p();var g=b("MercuryConfig").activity_limit||6e4,h=b("MercuryConfig").idle_limit||18e5,i=b("MercuryConfig").idle_poll_interval||3e5,j=b("JSLogger").create("chat_activity"),k=Date.now(),l=!0;function a(){var a=Date.now();return!!(l&&a-k<g)}var m=Object.assign(new(b("Arbiter"))(),{isActive:a});function n(){var a=k;k=Date.now();k-a>h&&(j.debug("idle_to_active",a),b("PresenceState").doSync());m.inform("activity")}b("Event").listen(window,"focus",function(){l=!0,n()});b("Event").listen(window,"blur",function(){l=!1});b("UserActivity").subscribe(function(){n()});function o(a){a=a&&a.at&&b("PresenceState").verifyNumber(a.at);typeof a!=="number"&&(a=null);return a||0}setInterval(function(){var a=Date.now(),c=o(b("PresenceState").get()),d=Math.max(k,c);a-d>h&&(j.debug("idle",{cookie:c,local:k}),m.inform("idle",a-d))},i);b("PresenceState").registerStateStorer(function(a){var b=o(a);b<k&&(a.at=k);return a});b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(a,b){b.chat_activity={activity_limit:g,idle_limit:h,idle_poll_interval:i,last_active_time:k}});e.exports=m}),null);
__d("MercuryNotificationRenderer",["fbt","MercuryAssert","MercuryIDs","MercuryMessages","MercuryParticipants","MercuryThreads","MercuryViewer","MessagingGenericAdminTextType"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MercuryMessages").get(),i=b("MercuryThreads").get(),j="source:messenger_growth:event_upcoming_bump";function a(a,c){__p&&__p();b("MercuryAssert").isThreadID(a),i.getThreadMeta(a,function(d){__p&&__p();h.getThreadMessagesRange(a,0,1,function(e){__p&&__p();e=e.length&&e[e.length-1];var f=[];e.tags!==undefined&&(f=f.concat(e.tags));e.log_message_data&&(e.log_message_data.message_type==b("MessagingGenericAdminTextType").CONFIRM_FRIEND_REQUEST||e.log_message_data.message_type==b("MessagingGenericAdminTextType").WORK_INVITE_CLAIMED)?c(g._("New contact added")):f.indexOf(j)!==-1?c(g._("Vous avez un \u00e9v\u00e8nement \u00e0 venir.")):e&&e.author!=b("MercuryViewer").getID()?b("MercuryParticipants").get(e.author,function(e){var f=e.short_name,h=d.custom_nickname;if(h){e=b("MercuryIDs").getUserIDFromParticipantID(e.id);h[e]&&(f=h[e])}d.name?c(g._("{senderName} a envoy\u00e9 un message \u00e0 {groupName}",[g._param("senderName",f),g._param("groupName",d.name)])):b("MercuryIDs").isGroupChat(a)?c(g._("{name} a envoy\u00e9 un message \u00e0 votre groupe",[g._param("name",f)])):c(g._("{name} vous a envoy\u00e9 un message",[g._param("name",f)]))}):c(g._("Nouveau message\u00a0!"))})})}e.exports={renderDocumentTitle:a}}),null);
__d("MercuryTimestampTracker",["MercuryActionType","MercuryDispatcher","MercuryPayloadSource","MercurySingletonProvider"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};function a(a){this.$1=a,this.$3=0,this.$2=b("MercuryDispatcher").getForFBID(this.$1),this.$2.subscribe("update-messages",this.$4.bind(this))}a.prototype.$4=function(a,c){if(!c.actions||!c.actions.length)return;if(c.payload_source===b("MercuryPayloadSource").CLIENT_SEND_MESSAGE||c.payload_source===b("MercuryPayloadSource").UNKNOWN)return;for(var a=0;a<c.actions.length;a++){var d=c.actions[a],e=d.action_type;e==b("MercuryActionType").USER_GENERATED_MESSAGE&&d.thread_id&&d.timestamp>this.$3&&(this.$3=d.timestamp)}};a.prototype.getLastUserMessageTimestamp=function(){return this.$3};var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("ChatTitleBarBlinker",["ChatActivity","DocumentTitle","JSLogger","MercuryThreadInformer","MercuryNotificationRenderer","PresenceState","MercuryTimestampTracker"],(function(a,b,c,d,e,f){"use strict";__p&&__p();d=b("MercuryThreadInformer").get();var g=b("MercuryTimestampTracker").get(),h=b("JSLogger").create("chat_title"),i=null,j=0,k=!1;function l(){if(i){i.stop();i=null;return!0}return!1}function m(a){a=a||g.getLastUserMessageTimestamp();j<=a&&(j=a,(l()||k)&&b("PresenceState").doSync())}f={blink:function(a,c){!i&&j<c&&b("MercuryNotificationRenderer").renderDocumentTitle(a,function(a){i||(i=b("DocumentTitle").blink(a))})},stopBlinking:function(){m()},blinkingElsewhere:function(){k=!0}};function n(a){a=b("PresenceState").verifyNumber(a.sb2);return!a||a<=j?null:a}function a(a){a=a&&n(a);a&&(j=a,h.debug("load",j),l(),k=!1)}function c(a){var b=n(a);b||(h.debug("store",j),a.sb2=j,k=!1);return a}b("PresenceState").registerStateStorer(c);b("PresenceState").registerStateLoader(a);d.subscribe("thread-read-changed",function(a,b){a=g.getLastUserMessageTimestamp();var c=0;for(var d in b)b[d].mark_as_read&&b[d].timestamp>=a&&b[d].timestamp>c&&(c=b[d].timestamp);c&&m(c)});b("ChatActivity").subscribe("activity",function(){return m()});c=b("PresenceState").getInitial();c&&(j=n(c)||0);e.exports=f}),null);
__d("MercuryIgnoredBlockedParticipants.bs",["bs_caml_obj","bs_js_boolean","MercuryIDs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a,c,d){d=d.participants.filter(function(c){return+(c!==b("MercuryIDs").getParticipantIDFromUserID(a))});return d.filter(function(a){return+(+c.has(a)!==0)})}function a(a,c,d){return b("bs_js_boolean").to_js_boolean(1-+d.is_canonical&&+(g(a,c,d).length>0))}function c(a,b,c){if(c.is_canonical)return[];else return g(a,b,c)}function d(a,c,d){var e=+d.is_canonical;if(e!==0){e=d.participants.filter(function(c){return b("bs_caml_obj").caml_notequal(c,b("MercuryIDs").getParticipantIDFromUserID(a))});return b("bs_js_boolean").to_js_boolean(1-+e.every(function(a){return 1-+c.has(a)}))}else return!1}f.findIntersection=g;f.isPresentInGroupThread=a;f.participantsInGroupThread=c;f.qualifiesAs=d}),null);
__d("MercuryBrowserAlerts",["ArbiterMixin","ChatActivity","ChatConfig","ChatOptions","ChatTitleBarBlinker","CurrentUser","Event","MercuryIgnoredBlockedParticipants.bs","MercuryIDs","MercuryThreadInfo","MercuryThreads","MercuryViewer","MessagingTag","MessengerState.bs","Sound","UserActivity"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MercuryThreads").get(),h=3,i=6e5,j=new Map(),k=null;function l(){return!b("UserActivity").isOnTab()&&!b("UserActivity").hasBeenInactive()}function m(){j=new Map()}function n(a){b("ChatOptions").getSetting("sound")&&!l()&&b("Sound").play([b("ChatConfig").get("sound.notif_ogg_url"),b("ChatConfig").get("sound.notif_mp3_url")],a,!1)}var o=Object.assign({init:function(){b("Event").listen(window,"focus",function(){m(),clearInterval(k)}),b("Event").listen(window,"blur",function(){k=setInterval(m,i)})},messageReceived:function(a){__p&&__p();if(a.author&&b("MercuryViewer").isViewer(a.author)||!a.is_unread||a.folder!=b("MessagingTag").INBOX&&a.folder!=b("MessagingTag").ARCHIVED)return;var c=a.thread_id,d=b("ChatActivity").isActive();if(d){var e=!1;o.inform("before-alert",{threadID:c,cancelAlert:function(){e=!0}})}g.getThreadMeta(c,function(f){__p&&__p();var g=b("MercuryThreadInfo").isMuted(f),i=b("MercuryIDs").getUserIDFromParticipantID(b("MercuryViewer").getID());if(g)if(!b("MercuryThreadInfo").areMentionsMuted(f)){if(!a.profile_ranges||!a.profile_ranges.some||!a.profile_ranges.some(function(a){return a.id===i}))return}else return;var k=b("CurrentUser").getID();b("MessengerState.bs").compute(k,function(g){__p&&__p();g=g.blocked_ids;if(b("MercuryIgnoredBlockedParticipants.bs").isPresentInGroupThread(k,g,f))return;g=a.timestamp;if(d)e||n(g);else{b("ChatTitleBarBlinker").blink(c,g);var i=j.get(c)||0;i<h&&(j.set(c,i+1),n(g))}b("ChatTitleBarBlinker").blinkingElsewhere()})})}},b("ArbiterMixin"));e.exports=o}),null);
__d("ChatAppActions",["ChatDispatcher","ChatAppActionTypes"],(function(a,b,c,d,e,f){"use strict";a={tti:function(){b("ChatDispatcher").dispatch({type:b("ChatAppActionTypes").TTI})},hide:function(){b("ChatDispatcher").dispatch({type:b("ChatAppActionTypes").HIDE})},unhide:function(){b("ChatDispatcher").dispatch({type:b("ChatAppActionTypes").UNHIDE})},setInitialDisplayDone:function(){b("ChatDispatcher").dispatch({type:b("ChatAppActionTypes").INITIAL_DISPLAY_DONE})},load:function(){b("ChatDispatcher").dispatch({type:b("ChatAppActionTypes").LOAD})}};e.exports=a}),null);
__d("ChatPrivacyActionController",["ChatVisibility","JSLogger","PresencePrivacy"],(function(a,b,c,d,e,f){__p&&__p();a=function a(c,d){__p&&__p();this._userID=c;this._logger=b("JSLogger").create("blackbird");this._getState=function(){return b("ChatVisibility").isOnline()?b("PresencePrivacy").allows(this._userID)?a.NORMAL:a.BLOCKED:a.OFFLINE};this._togglePrivacy=function(){__p&&__p();this._getState();switch(this._getState()){case a.OFFLINE:if(b("ChatVisibility").isOnline()){this._logger.error("tabs_already_online");break}this._logger.log("tabs_go_online",{tab_id:this._userID});b("ChatVisibility").goOnline(function(){b("PresencePrivacy").allows(this._userID)||(this._getState()!==a.BLOCKED&&this._logger.error("privacy_action_controller_blocked_inconsistency"),this._togglePrivacy())}.bind(this));break;case a.BLOCKED:b("PresencePrivacy").allow(this._userID);this._logger.log("tabs_unblock",{tab_id:this._userID});break;case a.NORMAL:b("PresencePrivacy").disallow(this._userID);this._logger.log("tabs_block",{tab_id:this._userID});break}};c=function(){d&&d(this._getState())}.bind(this);c();this._subscribeToken=b("PresencePrivacy").subscribe("privacy-changed",c)};a.OFFLINE="offline";a.BLOCKED="blocked";a.NORMAL="normal";Object.assign(a.prototype,{togglePrivacy:function(){this._logger.log("gear_menu_toggle_privacy",{tab_id:this._userID}),this._togglePrivacy()},destroy:function(){this._subscribeToken&&b("PresencePrivacy").unsubscribe(this._subscribeToken)}});e.exports=a}),null);
__d("MontageDispatcher",["ExplicitRegistrationDispatcher"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("ExplicitRegistrationDispatcher"));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=new a({strict:!1})}),null);
__d("MontageActions",["MontageDispatcher","keyMirror"],(function(a,b,c,d,e,f){"use strict";var g=b("keyMirror")({REQUEST_UPDATE:null,HAS_UPDATED:null});a={Types:g,requestUpdate:function(a){b("MontageDispatcher").dispatch({type:g.REQUEST_UPDATE,threadFBID:a})},hasUpdated:function(a){b("MontageDispatcher").dispatch({type:g.HAS_UPDATED,threadFBID:a})}};e.exports=a}),null);
__d("DisplayGenderConst",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({UNKNOWN:"UNKNOWN",FEMALE:"FEMALE",MALE:"MALE",NEUTER:"NEUTER"})}),null);
__d("MessengerGroupsSyncStatus.bs",["MessengerGroupsSyncStatus"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){__p&&__p();if(a==null)return null;else switch(a){case"OPT_IN":return b("MessengerGroupsSyncStatus").OPT_IN;case"OPT_OUT":return b("MessengerGroupsSyncStatus").OPT_OUT;case"PENDING_OPT_IN":return b("MessengerGroupsSyncStatus").PENDING_OPT_IN;case"PENDING_OPT_OUT":return b("MessengerGroupsSyncStatus").PENDING_OPT_OUT;case"UNSET":return b("MessengerGroupsSyncStatus").UNSET;case"UNSUPPORTED":return b("MessengerGroupsSyncStatus").UNSUPPORTED;default:return null}}f.fromNullableString=a}),null);
__d("MessengerServerPayloadTransformer.bs",["URI","FBID.bs","bs_array","Utils.bs","bs_string","getByPath","bs_caml_array","bs_js_boolean","MercuryIDs","bs_caml_format","GenderConst","bs_js_primitive","WorkModeConfig","bs_js_null_undefined","DisplayGenderConst","MessagingThreadType","MessengerGroupsSyncStatus.bs","MessengerMessageTransformer.bs","MessengerAttachmentTransformer.bs","MessengerThreadCannotReplyReason"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){__p&&__p();var c=a.location_coordinates;c=c==null?[null,null]:[c.latitude,c.longitude];var d=a.location_page,e;if(d==null)e=null;else{d=d.address;e=d==null?null:d.full_address}d=a.allows_rsvp;d=d!==0?1:0;var f=b("bs_array").fold_left(function(a,b){a[b.node.id]=b.guest_list_state;return a},{},a.event_reminder_members.edges),g=a.lightweight_event_creator;return{creator_id:g==null?null:g.id,event_members:f,event_time:a.time,event_type:a.lightweight_event_type,latitude:c[0],longitude:c[1],location_address:e,location_name:a.location_name,note:a.note,oid:a.id,related_event:a.related_event,repeat_mode:a.repeat_mode,seconds_to_notify_before:a.seconds_to_notify_before,status:a.lightweight_event_status,title:a.event_title,track_rsvp:d}}function h(a){__p&&__p();a=a.associated_object;if(a==null)return null;else{var c=a.action_link,d;if(c==null)d=null;else{var e=+b("WorkModeConfig").is_work_user;e=e!==0?b("WorkModeConfig").company_subdomain+".facebook.com":"www.facebook.com";d=new(b("URI"))(c).setDomain(e)}c=a.profile_picture;return{id:a.id,name:a.name,action_link:d,profile_picture:c==null?null:{uri:c.uri},room_type:a.room_type,privacy_mode:a.privacy_mode,approval_mode_toggleable:a.approval_mode_toggleable,start_timestamp:a.start_timestamp,event_place:a.event_place,mentorship_program:a.mentorship_program}}}function i(a){a=a.related_page_thread;if(a==null)return null;else{var c=b("bs_array").map(function(a){return a.name},a.custom_thread_tags.nodes),d=a.page;d=d==null?null:d.id;return{flagged:a.is_flagged,pageID:d,customTagNames:c}}}function j(a){__p&&__p();var c=a.thread_key.other_user_id;if(c==null)return 0;else{a=a.all_participants.nodes;return b("bs_array").fold_left(function(a,b){b=b.messaging_actor;if(b.id===c)return+(b.__typename==="User");else return a},0,a)}}function k(a){__p&&__p();if(a.length){var c={};b("bs_array").iter(function(a){var b=a.nickname;if(b==null)return 0;else{c[a.participant_id]=b;return 0}},a);return c}else return null}function l(a){if(!(a==null)&&a!=="")return"#"+b("bs_string").sub(a,2,a.length-2|0);else return null}function a(a){return a.thread_key.thread_fbid}function c(a){return a.thread_key.other_user_id}function d(a){return b("bs_js_primitive").null_undefined_to_opt(b("getByPath")(a,["messages","page_info"]))}function m(a){__p&&__p();var c=a.gender,d=a.url,e;if(d==null)e=null;else{var f=+b("WorkModeConfig").is_work_user;f=f!==0?b("WorkModeConfig").company_subdomain+".facebook.com":"www.facebook.com";e=new(b("URI"))(d).getUnqualifiedURI().setDomain(f).setProtocol("https").toString()}d=a.big_image_src;f=a.big_image_src;var g=a.__typename,h;switch(g){case"Page":h="page";break;case"User":h="user";break;default:h=null}g=a.accepts_messenger_user_feedback;var i=a.is_viewer_friend,j=a.is_messenger_user,k=a.is_verified,l=a.is_messenger_platform_bot,m=a.is_message_blocked_by_viewer,n=a.is_viewer_subscribed_to_message_updates,o=a.is_viewer_coworker,p=a.scim_company_user,q;if(p==null)q=null;else{p=p.company_title;if(p==="")q=null;else{var r=b("bs_js_null_undefined").bind(a.work_info,function(a){return b("bs_js_null_undefined").bind(a.work_community,function(a){return a.name})}),s=b("Utils.bs").nullUndefinedBooleanToOptionBool(a.is_viewer_coworker);q=!(r==null)&&s&&s[0]===0?""+(String(p)+(" \u2022 "+(String(r)+""))):p}}s=a.is_employee;return{id:"fbid:"+a.id,fbid:a.id,gender:c==null?b("GenderConst").NOT_A_PERSON:c===b("DisplayGenderConst").MALE?b("GenderConst").MALE_SINGULAR:c===b("DisplayGenderConst").FEMALE?b("GenderConst").FEMALE_SINGULAR:b("GenderConst").NOT_A_PERSON,href:e,image_src:d==null?null:d.uri,big_image_src:f==null?null:f.uri,name:a.name,short_name:b("Utils.bs").$pipe$unknown(b("bs_js_primitive").null_undefined_to_opt(a.short_name),a.name),type:h,vanity:a.username,accepts_messenger_user_feedback:g==null?!1:g,is_friend:i==null?!1:i,is_messenger_user:j==null?!1:j,is_business_enabled:a.__typename==="Page"?!0:!1,is_verified:k==null?!1:k,is_messenger_platform_bot:l==null?!1:l,is_messenger_ignored:null,is_messenger_blocked:m==null?!1:m,is_subscribed_to_page_updates:n==null?!0:n,is_coworker:o==null?!0:o,title:q,employee:s==null?!1:s,instant_game_channel:a.__typename==="Page"?a.instant_game_channel:null}}function e(a){return b("bs_array").map(function(a){return m(a.messaging_actor)},a.all_participants.nodes)}function n(a,c){__p&&__p();c=c.read_receipts;if(c==null)return 0;else{var d={};b("bs_array").iter(function(c){var e=c.actor;if(!(e==null)&&a!==e.id){d[e.id]={action:b("bs_caml_format").caml_float_of_string(c.action),watermark:b("bs_caml_format").caml_float_of_string(c.watermark)};return 0}else return 0},c.nodes);return[d]}}function o(a){__p&&__p();a=a.delivery_receipts;if(a==null)return[];else return a.nodes.sort(function(a,c){a=b("bs_caml_format").caml_float_of_string(a.timestamp_precise);c=b("bs_caml_format").caml_float_of_string(c.timestamp_precise);if(a>c)return-1;else if(a===c)return 0;else return 1})}function p(a,c,d){var e=c.messages;if(e==null)return 0;else return[b("bs_array").map(function(e){return b("MessengerMessageTransformer.bs").transformMessage(a,e,{thread_id:null,thread_fbid:c.thread_key.thread_fbid,other_user_fbid:c.thread_key.other_user_id,folder:b("bs_string").lowercase(c.folder)},d)},e.nodes)]}function q(a,c,d){__p&&__p();var e=b("bs_array").map(function(c){var d=b("MessengerMessageTransformer.bs").unsafeCastBlobAttachments(c),e=c.extensible_attachment,f;if(e==null)f=null;else{var a=e.story_attachment;f={legacy_attachment_id:e.legacy_attachment_id,story_attachment:a==null?null:b("MessengerMessageTransformer.bs").unsafeCastExtensibleAttachment(a)}}return{snippet:c.snippet,message_sender:c.message_sender,timestamp_precise:c.timestamp_precise,commerce_message_type:c.commerce_message_type,extensible_attachment:f,blob_attachments:d,sticker:c.sticker,extensible_message_admin_text:c.extensible_message_admin_text}},c.last_message.nodes);e={thread_key:c.thread_key,name:c.name,all_participants:c.all_participants,last_message:{nodes:e},unread_count:c.unread_count,message_count:c.messages_count,image:c.image,updated_time_precise:c.updated_time_precise,mute_until:c.mute_until,is_pin_protected:c.is_pin_protected,is_viewer_subscribed:c.is_viewer_subscribed,is_canonical_neo_user:c.is_canonical_neo_user,thread_queue_enabled:c.thread_queue_enabled,folder:c.folder,has_viewer_archived:c.has_viewer_archived,is_page_follow_up:c.is_page_follow_up,cannot_reply_reason:c.cannot_reply_reason,ephemeral_ttl_mode:c.ephemeral_ttl_mode,customization_info:c.customization_info,thread_admins:c.thread_admins,approval_mode:c.approval_mode,joinable_mode:c.joinable_mode,thread_queue_metadata:c.thread_queue_metadata,event_reminders:c.event_reminders,montage_thread:c.montage_thread,last_read_receipt:c.last_read_receipt,related_page_thread:c.related_page_thread,rtc_call_data:c.rtc_call_data,associated_object:c.associated_object,reactions_mute_mode:c.reactions_mute_mode,mentions_mute_mode:c.mentions_mute_mode,privacy_mode:c.privacy_mode,customization_enabled:c.customization_enabled,thread_type:c.thread_type,participant_add_mode_as_string:c.participant_add_mode_as_string,participants_event_status:c.participants_event_status,marketplace_thread_data:c.marketplace_thread_data,page_comm_item:c.page_comm_item,group_approval_queue:c.group_approval_queue,admin_model_status_string:c.admin_model_status_string,groups_sync_status_string:c.groups_sync_status_string,groups_sync_metadata:c.groups_sync_metadata};c=e.customization_info;var f;if(c==null)f=[null,null,null];else{var m=c.emoji;f=[l(c.outgoing_bubble_color),m==null?null:{emoji:m},k(c.participant_customizations)]}m=e.page_comm_item;c=m==null?[null,null,null,null,null]:[m.comm_status,m.comm_source_id,m.id,m.subtitle,m.comm_item_owners];m=e.last_message.nodes.length?[b("bs_caml_array").caml_array_get(e.last_message.nodes,0)]:0;var n=e.last_read_receipt.nodes.length?[b("bs_caml_array").caml_array_get(e.last_read_receipt.nodes,0)]:0;if(m){var o=m[0];a=b("MessengerAttachmentTransformer.bs").transformAttachment(a,{extensible_attachment:o.extensible_attachment,blob_attachments:o.blob_attachments,sticker:o.sticker},d)}else a=[];if(m){o=m[0].extensible_message_admin_text;if(o==null)d=null;else{o=o.game;d=o==null?null:o.id}}else d=null;o=e.cannot_reply_reason;var p=e.thread_queue_metadata,q=e.thread_type,r=e.montage_thread,s=e.image,t=e.thread_key.other_user_id,u=e.thread_queue_metadata,v=e.name,w=e.thread_key.other_user_id;if(w==null){var x=e.thread_key.thread_fbid;x=x==null?null:x}else x=w;w=e.rtc_call_data;var y;if(w==null)y=null;else{var z=w.initiator;y={call_state:w.call_state,server_info_data:w.server_info_data,initiator_fbid:z==null?0:b("bs_caml_format").caml_float_of_string(z.id)}}w=e.marketplace_thread_data;if(w==null)z=null;else{var A=w.for_sale_item,B;if(A==null)B=null;else{var C=A.id,D=A.formatted_price,E=A.location,F;if(E==null)F=null;else{E=E.reverse_geocode;F={reverse_geocode:E==null?null:{city:E.city,state:E.state}}}E=A.primary_photo;var G;if(E==null)G=null;else{E=E.image;G=E==null?null:E.uri}B={id:C==null?0:b("bs_caml_format").caml_float_of_string(C),story_id:A.story_id,title:A.group_commerce_item_title,price:D==null?null:D.text,location:F,is_sold:A.is_sold,image_uri:G,url:A.url}}E=w.buyer;C=w.seller;z={for_sale_item:B,buyer_fbid:E==null?0:b("bs_caml_format").caml_float_of_string(E.id),seller_fbid:C==null?0:b("bs_caml_format").caml_float_of_string(C.id)}}D=e.group_approval_queue;F=e.groups_sync_metadata;if(F==null)G=null;else{A=F.fb_group;G=A==null?null:A.url}return{admin_ids:b("bs_array").map(function(a){return a.id},e.thread_admins),approval_mode:e.approval_mode,approval_queue_ids:p==null?[]:b("bs_array").map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(b("FBID.bs").ofStringExn(a.id))},p.approval_requests.nodes),can_reply:o==null?!0:!1,cannot_reply_reason:e.cannot_reply_reason,custom_color:f[0],custom_like_icon:f[1],custom_nickname:f[2],customization_enabled:e.customization_enabled,thread_type:q==null?null:b("bs_js_null_undefined").from_opt(b("bs_js_primitive").undefined_to_opt(b("MessagingThreadType")[q])),participant_add_mode:e.participant_add_mode_as_string,ephemeral_ttl_mode:e.ephemeral_ttl_mode,folder:b("bs_string").lowercase(e.folder),has_email_participant:o==null?!1:b("bs_js_boolean").to_js_boolean(+(o===b("MessengerThreadCannotReplyReason").HAS_EMAIL_PARTICIPANT)),has_montage:r==null?!1:!0,image_src:s==null?null:s.uri,is_archived:b("bs_js_boolean").to_js_boolean(e.has_viewer_archived),is_page_follow_up:b("bs_js_boolean").to_js_boolean(e.is_page_follow_up),is_canonical_user:b("bs_js_boolean").to_js_boolean(j(e)),is_canonical:t==null?!1:!0,is_pin_protected:b("bs_js_boolean").to_js_boolean(e.is_pin_protected),is_subscribed:b("bs_js_boolean").to_js_boolean(e.is_viewer_subscribed),is_canonical_neo_user:b("bs_js_boolean").to_js_boolean(e.is_canonical_neo_user),is_thread_queue_enabled:u==null?!1:!0,joinable_mode:{mode:b("bs_caml_format").caml_int_of_string(e.joinable_mode.mode),link:e.joinable_mode.link},last_message_timestamp:m?b("bs_caml_format").caml_float_of_string(m[0].timestamp_precise):0,last_message_type:m?m[0].commerce_message_type:null,last_read_timestamp:n?b("bs_caml_format").caml_float_of_string(n[0].timestamp_precise):0,lightweight_event:e.event_reminders.nodes.length?g(b("bs_caml_array").caml_array_get(e.event_reminders.nodes,0)):null,message_count:e.message_count,mute_until:e.mute_until,name:v==null?"":v,other_user_fbid:e.thread_key.other_user_id,page_thread_info:i(e),participants:b("bs_array").map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a.messaging_actor.id)},e.all_participants.nodes),participants_event_status:e.participants_event_status,read_only:o==null?!1:b("bs_js_boolean").to_js_boolean(+(o===b("MessengerThreadCannotReplyReason").READ_ONLY)),recipients_loadable:o==null?!0:b("bs_js_boolean").to_js_boolean(+(o!==b("MessengerThreadCannotReplyReason").RECIPIENTS_NOT_LOADABLE)),server_timestamp:b("bs_caml_format").caml_float_of_string(e.updated_time_precise),snippet_attachments:a,snippet_sender:m?b("MercuryIDs").getParticipantIDFromUserID(m[0].message_sender.messaging_actor.id):null,snippet:m?m[0].snippet:null,thread_fbid:x,thread_id:"",timestamp:b("bs_caml_format").caml_float_of_string(e.updated_time_precise),unread_count:e.unread_count,rtc_call_data:y,marketplace_thread_data:z,associated_object:h(e),reactions_mute_mode:e.reactions_mute_mode==="REACTIONS_NOT_MUTED"?0:1,mentions_mute_mode:e.mentions_mute_mode==="MENTIONS_NOT_MUTED"?0:1,comm_status:c[0],page_comm_item_id:c[2],comm_source_id:c[1],subtitle:c[3],comm_item_owners:c[4],group_approval_queue:D==null?null:D.nodes,game_id:d,admin_model_status:e.admin_model_status_string,groups_sync_status:b("MessengerGroupsSyncStatus.bs").fromNullableString(e.groups_sync_status_string),groups_sync_fb_url:G}}f.getThreadFBID=a;f.getOtherUserID=c;f.getMessagePageInfo=d;f.transformParticipant=m;f.transformParticipants=e;f.transformReadReceipts=n;f.transformDeliveryReceipts=o;f.transformMessages=p;f.transformThread=q}),null);
__d("MercuryCanonicalGroupThreadManager",["Bootloader","KeyedCallbackManager","MercuryIDs","MercuryPayloadSource","MercuryServerPayloadPreprocessor","MercurySingletonProvider","MercuryThreads","MessengerServerPayloadTransformer.bs","MercuryServerDispatcher","SubscriptionsHandler"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){this.$1=a,this.$2=new(b("KeyedCallbackManager"))(),this.$3=b("MercuryServerPayloadPreprocessor").getForFBID(this.$1),this.$6=b("MercuryThreads").getForFBID(this.$1),this.$4={},this.$8(),this.$9(),this.$7={}}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};a.prototype.getCanonicalGroupThreadIDForParticipants=function(a,b){a=this.$10(a);var c=this.$11(a);c=this.$2.executeOrEnqueue(c,b);this.$12(a);return c};a.prototype.unsubscribe=function(a){a&&this.$2.unsubscribe(a)};a.prototype.$11=function(a){return a.sort().join(",")};a.prototype.$13=function(a,c){c=b("MercuryIDs").getThreadIDFromThreadFBID(c);this.$2.setResource(a,c);this.$4[c]=a};a.prototype.$12=function(a){var c=this.$11(a);c={canonical_group_key:c,participants:a};b("MercuryServerDispatcher").trySend("/ajax/mercury/search_canonical_groups.php",c,null,this.$1)};a.prototype.$8=function(){b("MercuryServerDispatcher").registerEndpoints({"/ajax/mercury/search_canonical_groups.php":{request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,handler:function(a){this.handleUpdate(a)}.bind(this)}})};a.prototype.$10=function(a){a.indexOf(this.$1)===-1&&a.push(this.$1);return a};a.prototype.handleUpdate=function(a){if(a.graphql_payload){var c=b("MessengerServerPayloadTransformer.bs").transformThread(a.viewer,a.graphql_payload,a.for_page);this.$3.handleUpdate({threads:[c],payload_source:b("MercuryPayloadSource").SERVER_SEARCH})}c=a.canonical_group;if(c)for(var d in c)this.$13(d,c[d])};a.prototype.getNow=function(a){a=this.$11(this.$10(a));return this.$2.getResource(a)};a.prototype.$9=function(){b("Bootloader").loadModules(["MercuryThreadInformer"],function(a){a=a.getForFBID(this.$1);var c=new(b("SubscriptionsHandler"))();c.addSubscriptions(a.subscribe("threads-deleted",function(a,b){for(var c in b)this.$4[c]&&(this.$2.setResource(this.$4[c],undefined),delete this.$4[c])}.bind(this)));this.$5=c}.bind(this),"MercuryCanonicalGroupThreadManager")};var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("FantaGetMessageActions",["FantaDispatcher","MercuryCanonicalGroupThreadManager","MercuryIDs","MercuryTypeaheadConstants","keyMirror"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("keyMirror")({ADD_PARTICIPANTS:null,CLEAR_PARTICIPANTS:null,CLEAR_PREVIEW:null,FETCH_MORE_MESSAGES:null,ON_BOOTLOAD_TYPEAHEAD:null,ON_GET_APPROVAL_QUEUE_RESPONSE:null,ON_GET_THREAD_PREVIEW_RESPONSE:null,ON_GET_THREAD_RESPONSE:null,ON_MESSAGE_STORE_RESPONSE:null,ON_PAGE_NULL_RESPONSE:null,ON_PRIVACY_STATE_CHANGE:null,ON_SHOW_CONTEXT_BANNER_TIMER:null,REFRESH_THREAD:null,THREADS_UPDATED:null});a={Types:g,addParticipants:function(a,c){__p&&__p();var d=c.length===1&&c[0].getInfo().render_type===b("MercuryTypeaheadConstants").THREAD_TYPE,e=void 0;if(d){d=c[0].getInfo().mercury_thread;d&&(e=b("MercuryIDs").getThreadIDFromThreadFBID(d.thread_fbid))}else if(c.length===1){d=c[0].info&&c[0].info.uid;d&&(e=b("MercuryIDs").getThreadIDFromUserID(d))}else if(c.length===0){b("FantaDispatcher").dispatch({type:g.CLEAR_PARTICIPANTS,tabID:a});return}else(function(){var d=b("MercuryCanonicalGroupThreadManager").get(),e=c.map(function(a){return a.info.uid});b("FantaDispatcher").dispatch({type:g.CLEAR_PREVIEW,tabID:a,tokens:c});var f=d.getCanonicalGroupThreadIDForParticipants(Array.from(e),function(e){d.unsubscribe(f),e&&b("FantaDispatcher").dispatch({type:g.ADD_PARTICIPANTS,previewTabID:e,tabID:a,tokens:c})})})();e&&b("FantaDispatcher").dispatch({type:g.ADD_PARTICIPANTS,previewTabID:e,tabID:a,tokens:c})},onBootloadTypeahead:function(a,c){b("FantaDispatcher").dispatch({type:g.ON_BOOTLOAD_TYPEAHEAD,tabID:a,thread:c})},fetchMoreMessages:function(a){b("FantaDispatcher").dispatch({type:g.FETCH_MORE_MESSAGES,threadID:a})},refreshThread:function(a){b("FantaDispatcher").dispatch({type:g.REFRESH_THREAD,threadID:a})},onGetThreadResponse:function(a){b("FantaDispatcher").dispatch({type:g.ON_GET_THREAD_RESPONSE,thread:a})},onGetThreadPreviewResponse:function(a,c){b("FantaDispatcher").dispatch({type:g.ON_GET_THREAD_PREVIEW_RESPONSE,tabID:a,thread:c})},onApprovalQueueResponse:function(a,c){b("FantaDispatcher").dispatch({type:g.ON_GET_APPROVAL_QUEUE_RESPONSE,membershipParticipants:c,tabID:a})},onShowContextBannerTimer:function(a){b("FantaDispatcher").dispatch({type:g.ON_SHOW_CONTEXT_BANNER_TIMER,threadID:a})},onMessageStoreResponse:function(a,c){b("FantaDispatcher").dispatch({type:g.ON_MESSAGE_STORE_RESPONSE,messages:a,tabID:c})},threadsUpdated:function(a){b("FantaDispatcher").dispatch({type:g.THREADS_UPDATED,threads:a})},onPrivacyStateChange:function(a,c){b("FantaDispatcher").dispatch({type:g.ON_PRIVACY_STATE_CHANGE,threadID:a,privacyState:c})},onPageNullResponse:function(a,c){b("FantaDispatcher").dispatch({type:g.ON_PAGE_NULL_RESPONSE,threadID:a,nullStateCTA:c})}};e.exports=a}),null);
__d("FantaTabSheetActions",["FantaDispatcher","LogHistory","keyMirror"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("keyMirror")({CLOSE_ADD_FRIENDS_SHEET:null,CLOSE_ADD_MORE_FRIENDS_SHEET:null,CLOSE_EMPLOYEE_PERSONAL_USER_SHEET:null,CLOSE_EMPLOYEE_WORK_USER_SHEET:null,CLOSE_NAME_CONVERSATION_TAB_SHEET:null,CLOSE_PAGE_INDICATOR_SHEET:null,CLOSE_READ_ONLY_PERMANENT_SHEET:null,CLOSE_READ_ONLY_SHEET:null,CLOSE_USER_FOCUS_AND_BYPASS_SHEET:null,CLOSE_USER_TIMEZONE_SHEET:null,ON_BOOTLOAD_EVENT_REMINDER:null,ON_WORK_DO_NOT_DISTURB_RESPONSE:null,ON_MENTORSHIP_PROGRAM_RESPONSE:null,ON_IS_PAGE_TAB:null,OPEN_ADD_MORE_FRIENDS_SHEET:null,OPEN_APPOINTMENT_SHEET:null,OPEN_BYPASS_FOCUS_SHEET:null,OPEN_EMPLOYEE_AWAY_SHEET:null,OPEN_EMPLOYEE_PERSONAL_USER_SHEET:null,OPEN_EMPLOYEE_WORK_USER_SHEET:null,OPEN_NAME_CONVERSATION_TAB_SHEET:null,OPEN_PAGE_INDICATOR_SHEET:null,OPEN_READ_ONLY_PERMANENT_SHEET:null,OPEN_READ_ONLY_SHEET:null,OPEN_USER_FOCUS_SHEET:null,OPEN_USER_TIMEZONE_SHEET:null,OPEN_WORK_DO_NOT_DISTURB_SHEET:null,OPEN_MENTORSHIP_PROGRAM_SHEET:null}),h=b("LogHistory").getInstance("fanta_sheets");function i(a){b("FantaDispatcher").dispatch(a),h.log(a.type,a.tabID)}a={Types:g,openUserFocusSheet:function(a){i({type:g.OPEN_USER_FOCUS_SHEET,tabID:a})},openBypassFocusSheet:function(a){i({type:g.OPEN_BYPASS_FOCUS_SHEET,tabID:a})},closeUserFocusAndBypassSheet:function(a){i({type:g.CLOSE_USER_FOCUS_AND_BYPASS_SHEET,tabID:a})},openUserTimezoneSheet:function(a,b){i({type:g.OPEN_USER_TIMEZONE_SHEET,tabID:a,timezoneInfo:b})},closeUserTimezoneSheet:function(a){i({type:g.CLOSE_USER_TIMEZONE_SHEET,tabID:a})},openAddMoreFriendsSheet:function(a){i({type:g.OPEN_ADD_MORE_FRIENDS_SHEET,tabID:a})},closeAddMoreFriendsSheet:function(a){i({type:g.CLOSE_ADD_MORE_FRIENDS_SHEET,tabID:a})},closeAddFriendsSheet:function(a){i({type:g.CLOSE_ADD_FRIENDS_SHEET,tabID:a})},openNameConversationSheet:function(a){i({type:g.OPEN_NAME_CONVERSATION_TAB_SHEET,tabID:a})},closeNameConversationSheet:function(a){i({type:g.CLOSE_NAME_CONVERSATION_TAB_SHEET,tabID:a})},openReadOnlySheet:function(a){i({type:g.OPEN_READ_ONLY_SHEET,tabID:a})},closeReadOnlySheet:function(a){i({type:g.CLOSE_READ_ONLY_SHEET,tabID:a})},openReadOnlyPermanentSheet:function(a){i({type:g.OPEN_READ_ONLY_PERMANENT_SHEET,tabID:a})},closeReadOnlyPermanentSheet:function(a){i({type:g.CLOSE_READ_ONLY_PERMANENT_SHEET,tabID:a})},openEmployeeAwaySheet:function(a){i({type:g.OPEN_EMPLOYEE_AWAY_SHEET,tabID:a})},openEmployeePersonalUserSheet:function(a){i({type:g.OPEN_EMPLOYEE_PERSONAL_USER_SHEET,tabID:a})},closeEmployeePersonalUserSheet:function(a){i({type:g.CLOSE_EMPLOYEE_PERSONAL_USER_SHEET,tabID:a})},openEmployeeWorkUserSheet:function(a){i({type:g.OPEN_EMPLOYEE_WORK_USER_SHEET,tabID:a})},closeEmployeeWorkUserSheet:function(a){i({type:g.CLOSE_EMPLOYEE_WORK_USER_SHEET,tabID:a})},openPageIndicatorSheet:function(a,b){i({type:g.OPEN_PAGE_INDICATOR_SHEET,description:b,tabID:a})},closePageIndicatorSheet:function(a){i({type:g.CLOSE_PAGE_INDICATOR_SHEET,tabID:a})},openWorkDoNotDisturbSheet:function(a,b){i({type:g.OPEN_WORK_DO_NOT_DISTURB_SHEET,description:b,tabID:a})},openMentorshipProgramSheet:function(a){i({type:g.OPEN_MENTORSHIP_PROGRAM_SHEET,tabID:a})},onIsPageTab:function(a,b){i({type:g.ON_IS_PAGE_TAB,pageIndicator:b,tabID:a})},onBootloadEventReminder:function(a){i({type:g.ON_BOOTLOAD_EVENT_REMINDER,tabID:a})},openAppointmentBannerSheet:function(a){i({type:g.OPEN_APPOINTMENT_SHEET,tabID:a})},onWorkDoNotDisturbResponse:function(a,b,c){i({type:g.ON_WORK_DO_NOT_DISTURB_RESPONSE,tabID:a,status:b,description:c})},onMentorshipProgramResponse:function(a,b,c){i({type:g.ON_MENTORSHIP_PROGRAM_RESPONSE,tabID:a,groupID:c,programName:b})}};e.exports=a}),null);
__d("MercurySheetPolicy",["keyMirror"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={ChatThreadIsMutedTabSheet:{isPermanent:!1,isSheetWithInput:!1},ChatUserFocusSheet:{isPermanent:!0,isSheetWithInput:!0},ChatUserFocusBypassSheet:{isPermanent:!0,isSheetWithInput:!0},ChatUserTimezoneSheet:{isPermanent:!0,isSheetWithInput:!0},ChatUserBlockedTabSheet:{isPermanent:!0,isSheetWithInput:!1},ChatUploadWarningTabSheet:{isPermanent:!1,isSheetWithInput:!1},ChatThreadIsMessageBlockedSheet:{isPermanent:!0,isSheetWithInput:!1},ChatReadOnlyTabSheet:{isPermanent:!1,isSheetWithInput:!1},ChatReadOnlyPermanentTabSheet:{isPermanent:!0,isSheetWithInput:!1},ChatOfflineTabSheet:{isPermanent:!0,isSheetWithInput:!1},ChatNoRecipientsTabSheet:{isPermanent:!0,isSheetWithInput:!1},ChatNewMessagesTabSheet:{isPermanent:!0,isSheetWithInput:!0},ChatNameConversationTabSheet:{isPermanent:!0,isSheetWithInput:!0},ChatEmployeeAwaySheet:{isPermanent:!0,isSheetWithInput:!1},ChatEventReminderTabSheet:{isPermanent:!0,isSheetWithInput:!1},ChatAppointmentBanner:{isPermanent:!0,isSheetWithInput:!1},ChatMontageSheet:{isPermanent:!1,isSheetWithInput:!1},ChatJoinCallSheet:{isPermanent:!0,isSheetWithInput:!1},FantaAddFriendsSheet:{isPermanent:!0,isSheetWithInput:!0},FantaAddMoreFriendsSheet:{isPermanent:!0,isSheetWithInput:!0},ChatRoomAssociatedObjectSheet:{isPermanent:!1,isSheetWithInput:!1},ChatWorkDoNotDisturbSheet:{isPermanent:!1,isSheetWithInput:!1},ChatMentorshipProgramSheet:{isPermanent:!1,isSheetWithInput:!1}};a={canReplaceOpenSheet:function(a,b){var c=this.getType(b),d=this.isPermanent(b);b=this.isSheetWithInput(b);var e=this.getType(a),f=this.isPermanent(a);a=this.isSheetWithInput(a);if(a)return!!(c!==e&&b);if(f&&!d)return!1;return e===this.sheets.ChatThreadIsMessageBlockedSheet?!1:!0},getType:function(a){var b=a.getType||a.type&&a.type.getType||function(){return a};b=b.call(a);return b},isPermanent:function(a){if(typeof a==="string"&&g[a])return g[a].isPermanent;var b=a.isPermanent||a.type&&a.type.isPermanent||function(){return!1};b=b.call(a);return b},isSheetWithInput:function(a){if(typeof a==="string"&&g[a])return g[a].isSheetWithInput;var b=a.isSheetWithInput||a.type&&a.type.isSheetWithInput||function(){return!1};b=b.call(a);return b},sheets:b("keyMirror")(g)};e.exports=a}),null);
__d("MessageRequestUtils",["MessagingTag"],(function(a,b,c,d,e,f){"use strict";a={isMessageRequest:function(a){return(a.folder===b("MessagingTag").PENDING||a.folder===b("MessagingTag").OTHER)&&a.can_reply},isFiltered:function(a){return a.folder===b("MessagingTag").OTHER}};e.exports=a}),null);
__d("TimeSpentRoomTypeEnum",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({GROUP:"GROUP",EVENT:"EVENT"})}),null);
__d("MessageThreadAssociatedObjectUtils",["TimeSpentRoomTypeEnum"],(function(a,b,c,d,e,f){"use strict";a={shouldRender:function(a){return a&&a.room_type===b("TimeSpentRoomTypeEnum").GROUP&&!a.is_workplace_community},isLinkedToGroupChat:function(a){return a&&a.room_type===b("TimeSpentRoomTypeEnum").GROUP&&!a.is_workplace_community}};e.exports=a}),null);
__d("MessengerApprovalModeTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({OPEN:0,APPROVALS:1})}),null);
__d("MessengerGroupAdminModelStatus",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({REQUIRED:"required",OPTIONAL:"optional",NOT_SUPPORTED:"not_supported"})}),null);
__d("MessengerJoinableModeType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({PRIVATE:0,JOINABLE:1})}),null);
__d("MessengerParticipantAddModeTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ADD:"ADD",INVITE:"INVITE",ADD_INVITE:"ADD_INVITE"})}),null);
__d("MessengerAdminGroupUtils",["fbt","CurrentUser","MercuryConfig","MercuryIDs","MessageThreadAssociatedObjectUtils","MessagingSourceEnum","MessageRequestUtils","MessengerApprovalModeTypes","MessengerGroupAdminModelStatus","MessengerJoinableModeType","MessengerParticipantAddModeTypes","QE2Logger","WorkModeConfig","gkx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h="messenger_use_new_group_participant_suggestion_ranking",i="show_nullstate_chat_tab_composer",j="show_nullstate_chat_tab_group_chat",k={isJoinableAndOpenThread:function(a){return this.isJoinableThread(a)&&this.isApprovalOpenThread(a)},isJoinableAndApprovalRequiredThread:function(a){return!!(this.isJoinableThread(a)&&a&&a.approval_mode===b("MessengerApprovalModeTypes").APPROVALS)},isWorkGroupSyncedChat:function(a){return!!(b("gkx")("AT7fEWlWLwzcomQ12uRE_cG5HZJE7FbXXRCfPurxhw8vIpN6D0E7mGAi-hDkDV8fg1mjxj-jQMaCESDTVOkEzzqV")&&a&&a.is_thread_queue_enabled===!0&&a.joinable_mode&&a.joinable_mode.mode===b("MessengerJoinableModeType").JOINABLE&&b("MessageThreadAssociatedObjectUtils").isLinkedToGroupChat(a.associated_object))},isWorkSyncedChatThreadCreationMessage:function(a){return!!(a.log_message_data&&a.log_message_data.name&&a.tags&&a.tags.indexOf(b("MessagingSourceEnum").WORK_GROUP_SYNCED_CHAT_CREATION)!==-1)},shouldAddToApprovalQueue:function(a,b){return!!(this.isJoinableAndApprovalRequiredThread(a)&&a&&!k.isAdmin(a.admin_ids,b))},isJoinableThread:function(a){return!!(b("gkx")("AT5xrCi08i7kM3hip_Bf4sUgmdKPV1QphRx_J6kDVSso_LwnuXnsPyhq98JRQV_MqHjleZ_pelk8UHK4mDklEDU4gdH-DgPi3glxyQ2_7CHTgw")&&a&&a.is_thread_queue_enabled===!0&&a.joinable_mode&&a.joinable_mode.mode===b("MessengerJoinableModeType").JOINABLE)},isGroupChat:function(a){return!!(a&&b("MessageThreadAssociatedObjectUtils").isLinkedToGroupChat(a.associated_object))},shouldInvite:function(a){return!!(b("gkx")("AT5xrCi08i7kM3hip_Bf4sUgmdKPV1QphRx_J6kDVSso_LwnuXnsPyhq98JRQV_MqHjleZ_pelk8UHK4mDklEDU4gdH-DgPi3glxyQ2_7CHTgw")&&a&&a.participant_add_mode===b("MessengerParticipantAddModeTypes").INVITE)},isApprovalOpenThread:function(a){return!!(b("gkx")("AT5xrCi08i7kM3hip_Bf4sUgmdKPV1QphRx_J6kDVSso_LwnuXnsPyhq98JRQV_MqHjleZ_pelk8UHK4mDklEDU4gdH-DgPi3glxyQ2_7CHTgw")&&a&&a.approval_mode===b("MessengerApprovalModeTypes").OPEN)},isAdminRequired:function(a){return!!(a&&a.admin_model_status===b("MessengerGroupAdminModelStatus").REQUIRED)},isOwner:function(a,b){return a&&(this.isJoinableThread(b)||this.canSeeAdminV2Feature(b))},canSeeAdminV2Feature:function(a){return b("gkx")("AT40OYqleZgx4_fLMr8MfXL_p194P9S4sUc6KbJKgvwElmT2Aj8TCRUAE4QBlOnOrqktka6w0qRv70XxEE3mR93T57P4MxmwmjYSU_ecGje_hg")&&this.isAdminRequired(a)},canSeeJoinableGroupOptions:function(a){var c=b("WorkModeConfig").is_work_user;return!c&&this.isJoinableThread(a)},canSeeGroupOptionsSection:function(a,c){var d=b("WorkModeConfig").is_work_user;c=this.isAdmin(a.admin_ids,c);return!d&&(this.isJoinableThread(a)||c&&this.canSeeAdminV2Feature(a))},canSeeBotsInGroupTypeahead:function(){var a=b("CurrentUser").isWorkUser();return a&&b("gkx")("AT5GhC4rylRpYKpnZf2oEtsedOSc0WCJLB5V8z6-mqCNieSKORSJnqenUlgYVRpQaRNASrJq2SeIYY3m4QNhPBlK")},canMakeOthersAdmins:function(a,b,c){return this.isOwner(a,c)&&!b},canMakeSelfAdmin:function(a,b){return(this.isJoinableThread(b)||this.isAdminRequired(b))&&b.admin_ids.length===0&&a},canRemoveAdmin:function(a,b,c){return this.isAdminRequired(c)&&c.admin_ids.length===1?!1:this.isOwner(a,c)&&b},canRemoveFromGroup:function(a,b){return this.isAdminRequired(b)?a:this.isOwner(a,b)||!this.isJoinableThread(b)},showJoinableLink:function(a){var b=!!(a&&a.joinable_mode&&a.joinable_mode.link);a=k.isJoinableThread(a);return a&&b},showJoinableApprovalToggle:function(a,b){if(a.associated_object&&!a.associated_object.approval_mode_toggleable)return!1;b=k.isAdmin(a.admin_ids,b);return k.isOwner(b,a)},showApprovalQueue:function(a,b){b=k.isAdmin(a.admin_ids,b);b=k.isOwner(b,a);var c=this.getPendingRequestNumber(a);if(a&&this.isAdminRequired(a))return this.isAdminRequired(a)&&b&&c>0;else{a=k.isJoinableAndApprovalRequiredThread(a);return a&&b&&c>0}},showParticipantsModal:function(a,b,c){return this.isJoinableThread(c)&&!a&&!b},useNewGroupMemberSuggestionRanking:function(){b("QE2Logger").logExposureForUser(h);return b("MercuryConfig").MessengerNewGroupParticipantSuggestionQE},showDefaultListForNewPersonAddChatTab:function(){b("QE2Logger").logExposureForUser(j);return b("MercuryConfig").ChatGroupChat},showDefaultListForNewChatTab:function(){b("QE2Logger").logExposureForUser(i);return b("MercuryConfig").ChatComposer},canUpdateThreadCustomization:function(a,c){var d=k.isJoinableThread(a);c=k.isAdmin(a.admin_ids,c);var e=b("MessageRequestUtils").isMessageRequest(a);return a.is_subscribed&&!e&&(!d||c)},isAdmin:function(a,c){if(!a)return!1;return b("MercuryIDs").isValid(c)?a.indexOf(b("MercuryIDs").getUserIDFromParticipantID(c))!==-1:a.indexOf(c)!==-1},getLeaveGroupBodyText:function(a,b){return this.isOwner(a,b)?g._("Si vous quittez ce groupe, vous n\u2019en serez plus propri\u00e9taire, et d\u2019autres membres pourront le g\u00e9rer. Vous ne pourrez plus envoyer ou recevoir de nouveaux messages."):g._("Vous ne recevrez plus de messages de cette conversation et les personnes verront que vous l\u2019avez quitt\u00e9e.")},getLeaveGroupTitleText:function(a,b){return this.isOwner(a,b)?g._("Quitter cette conversation\u00a0?"):g._("Quitter la conversation\u00a0?")},getLeaveGroupButtonText:function(a,b){return this.isOwner(a,b)?g._("Quitter la conversation"):g._("Quitter")},getMakeOwnerBodyText:function(a,b,c){if(a)return b?g._("En tant qu\u2019administrateur du groupe vous pourrez g\u00e9rer qui peut adh\u00e9rer et personnaliser cette conversion."):g._("En tant qu\u2019administrateur du groupe, {owner's name} pourra g\u00e9rer qui peut adh\u00e9rer et personnaliser cette conversation.",[g._param("owner's name",c)]);else return b?g._("En tant que propri\u00e9taire du groupe, vous pourrez en g\u00e9rer la propri\u00e9t\u00e9 et retirer des membres de la conversation. Seuls les propri\u00e9taires peuvent ajouter d\u2019autres propri\u00e9taires."):g._("En tant que propri\u00e9taire du groupe, {owner's name} pourra en g\u00e9rer la propri\u00e9t\u00e9 et retirer des membres de la conversation. Il pourra supprimer le droit de propri\u00e9t\u00e9 d\u2019autres propri\u00e9taires.",[g._param("owner's name",c)])},getMakeOwnerTitleText:function(a,b){if(a)return b?g._("Devenir administrateur du groupe\u00a0?"):g._("Nommer administrateur du groupe\u00a0?");else return b?g._("Devenir le propri\u00e9taire du groupe\u00a0?"):g._("Ajouter un propri\u00e9taire au groupe\u00a0?")},getMakeOwnerButtonText:function(a,b){if(a)return b?g._("Devenir administrateur"):g._("Nommer administrateur");else return b?g._("Devenez propri\u00e9taire"):g._("D\u00e9finir comme propri\u00e9taire")},getRemoveOwnerBodyText:function(a,b,c,d){if(b&&c)return a?null:g._("Vous ne g\u00e9rerez plus les propri\u00e9taires du groupe et ne pourrez plus supprimer de membres de cette conversation. Vous serez toujours un participant au groupe. Tout autre membre pourra devenir propri\u00e9taire du groupe.");else if(b&&!c)return a?g._("Vous ne pourrez plus g\u00e9rer qui peut adh\u00e9rer ni personnaliser cette conversation."):g._("Vous ne g\u00e9rerez plus les propri\u00e9taires du groupe et ne pourrez plus supprimer de membres de cette conversation. Vous serez toujours un participant au groupe.");else return a?g._("{owner's name} ne pourra plus g\u00e9rer qui peut adh\u00e9rer ni personnaliser cette conversation.",[g._param("owner's name",d)]):g._("{owner's name} ne g\u00e9rera plus la propri\u00e9t\u00e9 du groupe et ne pourra plus retirer des membres de la conversation. Il restera participant dans le groupe.",[g._param("owner's name",d)])},getRemoveOwnerTitleText:function(a){return a?g._("Supprimer des administrateurs du groupe\u00a0?"):g._("Supprimer des propri\u00e9taires du groupe\u00a0?")},getRemoveOwnerButtonText:function(a){return a?g._("Supprimer"):g._("Supprimer des propri\u00e9taires")},getPendingRequestNumber:function(a){if(a&&a.approval_queue_ids&&a.approval_queue_ids.length)return a.approval_queue_ids.length;else if(a&&this.isAdminRequired(a)&&a.group_approval_queue&&a.group_approval_queue.length)return a.group_approval_queue.length;return 0}};e.exports=k}),null);
__d("MessengerRoomPrivacyMode",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({WHITELISTED_MODE:0,PUBLIC_MODE:1})}),null);
__d("FantaComposeViewReducers",["Bootloader","FantaGetMessageActions","FantaTabSheetActions","MercuryDataSourceWrapper","MercurySheetPolicy","MercuryTypeaheadConstants","MessengerRoomPrivacyMode","MessengerAdminGroupUtils","ifRequired"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FantaGetMessageActions").Types,h=b("FantaTabSheetActions").Types;function a(a,b){switch(b.type){case g.ON_GET_THREAD_RESPONSE:case g.ON_GET_THREAD_PREVIEW_RESPONSE:var c=b.thread;b=b.tabID||c.thread_id;a=i(a,c,b)}return a}function i(a,c,d){c.participants.length===0&&(a=j(a,d,c),a=l(a,d,b("MercurySheetPolicy").sheets.FantaAddFriendsSheet));return a}function c(a,b){switch(b.type){case g.ON_BOOTLOAD_TYPEAHEAD:b=b.thread;var c=b.thread_id;a=j(a,c,b)}return a}function j(a,c,d){__p&&__p();var e=a.mercury.tabContents.get(c);if(!e||e.typeahead)return a;b("ifRequired")("ChatTabTypeaheadRenderer",function(f){__p&&__p();b("ifRequired")("ContextualTypeaheadView",function(g){__p&&__p();b("ifRequired")("MercuryTypeahead",function(h){__p&&__p();if(!a.mercury.tabContents.get(c))return;var i=!!(d&&d.participants&&d.participants.length===0),j=!!(d&&d.associated_object&&d.associated_object.privacy_mode===b("MessengerRoomPrivacyMode").WHITELISTED_MODE),k=i?b("MercuryDataSourceWrapper").chat_typeahead_source:j?b("MercuryDataSourceWrapper").chat_add_people_froup_source:b("MercuryDataSourceWrapper").chat_add_people_source;k.setShowThreads(i);i?k.setShowDefaultList(b("MessengerAdminGroupUtils").showDefaultListForNewChatTab()):j||k.setShowDefaultList(b("MessengerAdminGroupUtils").showDefaultListForNewPersonAddChatTab());j&&k.setQueryData({thread_id:d.thread_fbid});i=new h(k,g);i.setViewOption("renderer",f);i.setExcludedParticipantsFromThreadMeta(d);e=e.merge({typeahead:i});a=a.setIn(["mercury","tabContents",c],e)},function(){return k(c,d)})},function(){return k(c,d)})},function(){return k(c,d)});return a}function d(a,c){switch(c.type){case h.OPEN_ADD_MORE_FRIENDS_SHEET:var d=c.tabID,e=a.mercury.tabContents.get(d).thread;if(e){a=j(a,d,e);return l(a,c.tabID,b("MercurySheetPolicy").sheets.FantaAddMoreFriendsSheet)}}return a}function k(a,c){b("Bootloader").loadModules(["ChatTabTypeaheadRenderer","ContextualTypeaheadView","MercuryTypeahead"],function(d,e,f){b("FantaGetMessageActions").onBootloadTypeahead(a,c)},"FantaComposeViewReducers")}function l(a,c,d){__p&&__p();var e=a.mercury.tabContents.get(c),f=a.tabGroup.tabs.get(c);if(!f||!e)return a;f=e;f=f.openSheet;if(f&&!b("MercurySheetPolicy").canReplaceOpenSheet(f,d))return a;e=e.merge({openSheet:d});a=a.setIn(["mercury","tabContents",c],e);return a}function f(a,c){switch(c.type){case g.ADD_PARTICIPANTS:var d=c.tokens;c=c.tabID;d=d.length===1&&d[0].getInfo().render_type===b("MercuryTypeaheadConstants").THREAD_TYPE;if(!d)return l(a,c,b("MercurySheetPolicy").sheets.FantaAddFriendsSheet)}return a}e.exports={addParticipants:f,onBootloadTypeahead:c,onGetThreadResponse:a,openAddMoreFriends:d}}),null);
__d("FantaTypeFileUploader",["immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=Object.freeze({ANIMATED_IMAGE:"animated_image",AUDIO:"audio",FILE:"file",GENERIC_ATTACHMENT:"generic_attachment",IMAGE:"image",VIDEO:"video"});d={uploadedFiles:b("immutable").Map(),uploadingFiles:b("immutable").Map()};g=babelHelpers.inherits(a,b("immutable").Record(d));g&&g.prototype;a.prototype.getTypeIDs=function(a){return this.uploadedFiles.reduce(function(b,c){c.type===a&&c.uploadedID&&(b=b.concat(c.uploadedID));return b},[])};function a(){g.apply(this,arguments)}a.fileTypes=c;e.exports=a}),null);
__d("FantaTypeSharePreview",["immutable"],(function(a,b,c,d,e,f){"use strict";var g;c={isLoading:!1,params:null,type:null,uri:null};g=babelHelpers.inherits(a,b("immutable").Record(c));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("FantaTypeComposer",["FantaTypeFileUploader","FantaTypeSharePreview","immutable"],(function(a,b,c,d,e,f){"use strict";var g,h=0;c={fileUploader:new(b("FantaTypeFileUploader"))(),sharePreview:new(b("FantaTypeSharePreview"))(),text:"",version:h};d=babelHelpers.inherits(a,b("immutable").Record(c));g=d&&d.prototype;function a(){g.constructor.call(this,{version:++h})}e.exports=a}),null);
__d("FantaMessageActions",["Bootloader","FantaDispatcher","FantaTypeComposer","MercuryConfig","ifRequired","keyMirror","emptyFunction","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("keyMirror")({CANCEL_FILE_UPLOAD:null,COMPOSER_TEXT_UPDATE:null,LINK_PREVIEW:null,LOADED_SHARE_DATA:null,LOADING_SHARE_DATA:null,PREPARE_FILES_FOR_SEND:null,RECEIVED_NEW_MESSAGE:null,REMOVE_SHARE_PREVIEW:null,SEND_GROUP_MESSAGE:null,SEND_HOT_LIKE:null,SEND_MESSAGE:null,SEND_PHOTO:null,SEND_STICKER:null,UPDATE_GROUP_NAME:null,UPLOAD_FILE_FAILED:null,UPLOADED_FILE:null});function h(){var a=document.createElement("form");a.action=b("MercuryConfig").upload_url;a.method="post";return a}function i(a,b){var c=document.createElement("input");c.type="file";c.name="attachment[]";c.multiple=!0;b&&(c.onchange=b);a.appendChild(c);return c}var j={Types:g,prepareFilesForSend:function(a,c,d,e){this.dispatchOrBootloadUploader(function(){b("FantaDispatcher").dispatch({type:g.PREPARE_FILES_FOR_SEND,tabID:a,files:c,composer:d}),e&&e()})},openUploadFilePicker:function(a,b){var c=h();c=i(c,function(){j.prepareFilesForSend(a,this.files,b)});c.click()},uploadedFile:function(a,c,d){this.dispatchOrBootloadUploader(function(){b("FantaDispatcher").dispatch({type:g.UPLOADED_FILE,tabID:a,uploadID:c,payload:d})})},uploadFileFailed:function(a,c){this.dispatchOrBootloadUploader(function(){b("FantaDispatcher").dispatch({type:g.UPLOAD_FILE_FAILED,tabID:a,uploadID:c})})},cancelFileUpload:function(a,c){this.dispatchOrBootloadUploader(function(){b("FantaDispatcher").dispatch({type:g.CANCEL_FILE_UPLOAD,tabID:a,uploadID:c})})},linkPreview:function(a,c){this.dispatchOrBootloadSharePreview(function(){b("FantaDispatcher").dispatch({type:g.LINK_PREVIEW,tabID:a,uri:c})})},loadedShareData:function(a,c,d){this.dispatchOrBootloadSharePreview(function(){b("FantaDispatcher").dispatch({type:g.LOADED_SHARE_DATA,tabID:a,attachmentData:c,composer:d})})},loadingShareData:function(a,c){this.dispatchOrBootloadSharePreview(function(){b("FantaDispatcher").dispatch({type:g.LOADING_SHARE_DATA,composer:c,tabID:a})})},removeSharePreview:function(a,c){this.dispatchOrBootloadSharePreview(function(){b("FantaDispatcher").dispatch({type:g.REMOVE_SHARE_PREVIEW,tabID:a,composer:c})})},receivedNewMessage:function(a,c){b("FantaDispatcher").dispatch({type:g.RECEIVED_NEW_MESSAGE,tabID:a,message:c})},updateGroupName:function(a,c){this.dispatchOrBootloadSendMessages(function(){b("FantaDispatcher").dispatch({type:g.UPDATE_GROUP_NAME,threadID:a,newName:c})})},sendGroupMessage:function(a,c){this.dispatchOrBootloadSendMessages(function(){b("FantaDispatcher").dispatch({type:g.SEND_GROUP_MESSAGE,threadID:a,onSendSuccess:c})})},sendMessage:function(a,c,d,e){this.dispatchOrBootloadSendMessages(function(){b("FantaDispatcher").dispatch({type:g.SEND_MESSAGE,threadID:a,message:c,composer:d,onSendSuccess:e})})},sendPhoto:function(a,c,d){this.dispatchOrBootloadSendMessages(function(){b("FantaDispatcher").dispatch({type:g.SEND_PHOTO,onSendSuccess:d,photoData:c,threadID:a})})},sendHotLike:function(a,c,d,e,f){this.dispatchOrBootloadSendMessages(function(){b("FantaDispatcher").dispatch({type:g.SEND_HOT_LIKE,emoji:c,onSendSuccess:f,size:d,source:e,threadID:a})})},sendSticker:function(a,c,d){this.dispatchOrBootloadSendMessages(function(){b("FantaDispatcher").dispatch({type:g.SEND_STICKER,threadID:a,stickerID:c,onSendSuccess:d})})},composerTextUpdate:function(a,c,d){c.length>0&&b("ifRequired")("FantaReducersSendMessages",b("emptyFunction"),function(){return this.dispatchOrBootloadSendMessages(b("emptyFunction"))}.bind(this)),this.dispatchOrBootloadSharePreview(function(){b("FantaDispatcher").dispatch({type:g.COMPOSER_TEXT_UPDATE,composer:d,message:c,threadID:a})})},dispatchOrBootloadSendMessages:function(a){b("ifRequired")("FantaReducersSendMessages",function(){b("setImmediate")(a)},function(){b("Bootloader").loadModules(["FantaAppStore","FantaReducersSendMessages"],function(c,d){c.addReducers(d),b("setImmediate")(a)},"FantaMessageActions")})},dispatchOrBootloadUploader:function(a){b("ifRequired")("FantaReducersFileUploader",function(){a()},function(){b("Bootloader").loadModules(["FantaAppStore","FantaReducersFileUploader"],function(b,c){b.addReducers(c),a()},"FantaMessageActions")})},dispatchOrBootloadSharePreview:function(a){b("ifRequired")("FantaReducersSharePreview",function(){a()},function(){b("Bootloader").loadModules(["FantaAppStore","FantaReducersSharePreview"],function(b,c){b.addReducers(c),a()},"FantaMessageActions")})}};e.exports=j}),null);
__d("FantaReducersCookie",["FantaMessageActions","FantaTabActions","PresenceState","throttle"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FantaMessageActions").Types,h=b("FantaTabActions").Types,i=b("throttle").acrossTransitions(b("PresenceState").doSync,500);function a(a,b){switch(b.type){case g.RECEIVED_NEW_MESSAGE:case h.CLOSE_ALL_TABS:case h.CLOSE_AND_TAB_NEXT:case h.CLOSE_TAB:case h.DELETE_TAB:case h.MINIMIZE_ALL_TABS:case h.MINIMIZE_TAB:case h.OPEN_TAB:case h.OPEN_TAB_WITH_INTERSTITIAL_DATA:case h.REPLACE_TAB:case h.UNMINIMIZE_TAB:i();return j(a)}return a}function c(a,b){switch(b.type){case h.LOAD_FROM_DATA:var c=a.tabGroup;b=b.tabData;c=c.updatedTime;c=c>=b.updatedTime||b.updatedTime===undefined?c:b.updatedTime;return a.mergeIn(["tabGroup"],{updatedTime:c})}return a}function j(a){return a.mergeIn(["tabGroup"],{updatedTime:Date.now()})}e.exports={updateCookie:a,loadFromData:c}}),null);
__d("FantaReducersDockCalculator",["Arbiter","FantaTabActions","FantaMessageActions","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FantaTabActions").Types,h=b("FantaMessageActions").Types,i=null;function j(a){i=a,b("setImmediate")(function(){b("Arbiter").inform("FantaReducersDockCalculator/shouldRecalculate")})}function k(a){if(!i||a.size!==i.size)j(a);else{var b=!1;a.forEach(function(a){var c=i&&i.get(a.id);(!c||a.isMinimized!==c.isMinimized)&&(b=!0)});b&&j(a)}}function a(a,b){var c=a.tabGroup.tabs;switch(b.type){case g.CLOSE_ALL_TABS:case g.CLOSE_AND_TAB_NEXT:case g.CLOSE_TAB:case g.DELETE_TAB:case g.MINIMIZE_ALL_TABS:case g.MINIMIZE_TAB:case g.OPEN_TAB:case g.OPEN_TAB_WITH_INTERSTITIAL_DATA:case g.UNMINIMIZE_TAB:j(c);break;case g.LOAD_FROM_DATA:case h.RECEIVED_NEW_MESSAGE:k(c);break}return a}e.exports={recalculateDock:a}}),null);
__d("FantaReducersLogging",["Bootloader","FantaTabActions","FantaTabSheetActions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FantaTabActions").Types,h=b("FantaTabSheetActions").Types;function a(a,c){__p&&__p();switch(c.type){case h.OPEN_ADD_MORE_FRIENDS_SHEET:case g.OPEN_TAB:if(c.type===g.OPEN_TAB&&c.entryPoint!=="compose_link"&&c.entryPoint!=="jewel_new_message")return a;var d=a.mercury.tabContents.get(c.tabID);d&&b("Bootloader").loadModules(["MessengerSecondarySearchFunnelLogger","MessengerSecondarySearchFunnelConstants"],function(a,b){var e="";switch(c.entryPoint){case"compose_link":e=b.TAGS.SIDEBAR;break;case"jewel_new_message":e=b.TAGS.JEWEL;break}a.startFunnel(b.TAGS.WWW,b.TAGS.OMNIPICKER,e,c.type===h.OPEN_ADD_MORE_FRIENDS_SHEET?d.id:null,d.loggingID)},"FantaReducersLogging");break}return a}function c(a,c){switch(c.type){case g.CLOSE_ALL_TABS:case g.CLOSE_AND_TAB_NEXT:case g.CLOSE_TAB:case g.DELETE_TAB:case g.OPEN_TAB:case g.OPEN_TAB_WITH_INTERSTITIAL_DATA:var d=a.tabGroup.allowedRaisedTabs;c=a.tabGroup.getRaisedandUnraisedTabs();var e=c.raisedTabs;c=c.unraisedTabs;var f=e.count(),h=f+c.count();b("Bootloader").loadModules(["FantaTabsVisibleTypedLogger"],function(a){new a().setAllowedRaisedTabs(d).setOpenTabs(h).setVisibleTabs(f).log()},"FantaReducersLogging")}return a}e.exports={updateVisibleTabs:c,logSearchEventsAfterAction:a}}),null);
__d("FantaTypeJoinableThread",["immutable"],(function(a,b,c,d,e,f){"use strict";var g;c={admins:[],approvalMode:0,associatedObject:null,description:null,friendsInParticipants:[],imageURL:null,isViewerSubscribed:!1,isWorkpaceChat:!1,joinableMode:{mode:0,link:""},linkHash:"",participants:[],threadID:null,threadFBID:null,threadName:null};g=babelHelpers.inherits(a,b("immutable").Record(c));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("FantaTypeTabContents",["ChatPrivacyActionController","FantaGetMessageActions","FantaTypeComposer","immutable","ImmutableObject","MercuryIDs","emptyFunction","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c={composer:new(b("FantaTypeComposer"))(),hasFetchedAll:!1,id:"",isMultiCompany:null,isScrolledToBottom:!0,joinableInterstitialData:null,membershipParticipants:null,mentorship:null,messages:b("immutable").List(),messageStore:null,nullStateCTA:null,openSheet:null,pageIndicator:null,pageIndicatorDescription:null,privacyController:null,showContextBanner:!1,showUnseenMessages:b("emptyFunction"),signatureID:null,thread:null,threadPreviewID:null,threadPreviewRecipients:null,timezoneInfo:null,typeahead:null,workAvailabilityHumanReadable:null,workAvailabilityStatus:null,loggingID:null};d=babelHelpers.inherits(a,b("immutable").Record(c));g=d&&d.prototype;function a(a){var c=void 0,d=b("MercuryIDs").getUserIDFromThreadID(a.id);d&&(c=new(b("ChatPrivacyActionController"))(d,function(c){b("setImmediate")(function(){b("FantaGetMessageActions").onPrivacyStateChange(a.id,c)})}));g.constructor.call(this,babelHelpers["extends"]({privacyController:c},a))}e.exports=a}),null);
__d("FantaReducersMercury",["Arbiter","AsyncSignal","AvailableList","AvailableListConstants","Bootloader","FantaAvailableStatus","FantaGetMessageActions","FantaMessageActions","FantaTabActions","FantaTabSheetActions","FantaTypeJoinableThread","FantaTypeTabContents","JSLogger","MercuryIDs","MercuryThreadIDMap","TimeSlice","WorkFocusMode","getPageIDFromThreadID","ifRequired","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MercuryThreadIDMap").get(),h=b("JSLogger").create("FantaReducersMercury"),i=b("FantaMessageActions").Types,j=b("FantaTabActions").Types,k=b("FantaGetMessageActions").Types,l=1;function m(){return Math.floor(Math.random()*2147483648).toString(16)}function a(a,c){__p&&__p();switch(c.type){case j.OPEN_TAB:case j.OPEN_TAB_WITH_INTERSTITIAL_DATA:var d=c.tabID;b("ifRequired")("FantaTabsReactApp",function(c){!b("MercuryIDs").isValidThreadID(d)?(a=a.deleteIn(["tabGroup","tabs",d]),r(d)):z(a,d)},function(){return a=n(a,c.tabID)});a=o(a,d);var e=m(),f=a.mercury.tabContents.get(d);f=f.merge({signatureID:e,loggingID:l++});a=a.setIn(["mercury","tabContents",d],f);new(b("AsyncSignal"))("/ajax/chat/opentab_tracking.php",{threadID:d,userID:b("MercuryIDs").getUserIDFromThreadID(d),signatureID:e}).send();if(c.interstitialData){e=new(b("FantaTypeJoinableThread"))(c.interstitialData);f=f.merge({joinableInterstitialData:e});a=a.setIn(["mercury","tabContents",d],f)}b("Arbiter").inform("jewel/hide");return a}return a}function n(a,c){b("ifRequired")("FantaTabsSlimApp",function(d){!b("MercuryIDs").isValidThreadID(c)?(a=a.deleteIn(["tabGroup","tabs",c]),r(c)):z(a,c)},function(){z(a,c)});return a}function c(a,b){switch(b.type){case i.RECEIVED_NEW_MESSAGE:a=o(a,b.tabID)}return a}function o(a,c){__p&&__p();var d=a.mercury.tabContents.get(c);if(!d){d=function(){__p&&__p();var d=b("getPageIDFromThreadID")(c);d&&b("Bootloader").loadModules(["PagesMercuryChatTabIndicatorHandler"],function(a){var e=b("AvailableListConstants").OFFLINE,f=new a(d,e,function(a){b("setImmediate")(function(){b("FantaTabSheetActions").openPageIndicatorSheet(c,a)})},function(){b("setImmediate")(function(){return b("FantaTabSheetActions").closePageIndicatorSheet(c)})});b("setImmediate")(function(){b("FantaTabSheetActions").onIsPageTab(c,f)});f.checkResponsiveness()},"FantaReducersMercury");return{v:a.setIn(["mercury","tabContents",c],new(b("FantaTypeTabContents"))({id:c}))}}();if(typeof d==="object")return d.v}return a}function d(a,b){switch(b.type){case j.REPLACE_TAB:a=q(a,b.newTabID);a=o(a,b.newTabID);return a}return a}function f(a,b){__p&&__p();switch(b.type){case k.ADD_PARTICIPANTS:var c=b.tabID;b=b.previewTabID;var d=a.mercury.tabContents.get(c);if(!d)return a;d=d.merge({threadPreviewID:b});a=a.setIn(["mercury","tabContents",c],d);return a}return a}function p(a,c){switch(c.type){case k.CLEAR_PARTICIPANTS:c=c.tabID;var d=a.mercury.tabContents.get(c);d=d?d.loggingID:null;a=a.setIn(["mercury","tabContents",c],new(b("FantaTypeTabContents"))({id:c,loggingID:d}))}return a}function q(a,c){b("ifRequired")("FantaTabsReactApp",function(d){b("MercuryIDs").isValidThreadID(c)||(a=a.deleteIn(["tabGroup","tabs",c]),r(c))},function(){b("ifRequired")("FantaTabsSlimApp",function(d){b("MercuryIDs").isValidThreadID(c)||(a=a.deleteIn(["tabGroup","tabs",c]),r(c))})});return a}function r(a){g.getClientIDFromServerID(a,function(c){return b("setImmediate")(function(){b("MercuryIDs").isValidThreadID(c)?b("FantaTabActions").openTab(c):h.error("invalid id",a)})})}function s(a,b){switch(b.type){case j.FOCUS_TAB:z(a,b.tabID)}return a}function t(a,b){switch(b.type){case j.CLOSE_TAB:b=b.tabID;a=v(a,b)}return a}function u(a,b){switch(b.type){case j.DELETE_TAB:b=b.tabID;a=v(a,b);a=a.deleteIn(["mercury","tabContents",b])}return a}function v(a,c){b("ifRequired")("MessengerVideoAutoplayActions",function(a){a.deleteThread(c)});b("WorkFocusMode")&&b("WorkFocusMode").removeBypassFocusModeForThread(c);return a}function w(a,c){switch(c.type){case j.CLOSE_ALL_TABS:b("ifRequired")("MessengerVideoAutoplayActions",function(a){a.deleteAllThreads()});return a}return a}function x(a,b){switch(b.type){case j.FOCUS_NEXT_TAB:case j.FOCUS_PREVIOUS_TAB:case j.CLOSE_AND_TAB_NEXT:b=a.tabGroup.focusedTabID;b&&z(a,b)}return a}function y(a,c){switch(c.type){case j.CLOSE_AND_TAB_NEXT:c=c.tabID;b("WorkFocusMode")&&b("WorkFocusMode").removeBypassFocusModeForThread(c)}return a}function z(a,c){__p&&__p();var d=b("MercuryIDs").getUserIDFromThreadID(c);if(d){var e=function(){b("AvailableList").updateForID(d)};b("TimeSlice").guard(e,"superfluous request to first open DD",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()}e=a.mercury.tabContents.get(c);if(e){a=e.thread;e=e.pageIndicator;e&&e.notifyPageOnlineStatusChanged(b("FantaAvailableStatus").getStatus(a,c))}}function A(a,b){switch(b.type){case j.UNMINIMIZE_TAB:z(a,b.tabID)}return a}function B(a,b){__p&&__p();switch(b.type){case j.LOAD_FROM_DATA:for(var b=a.tabGroup.tabs.keys(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;a=o(a,e)}}return a}e.exports={addParticipants:f,clearParticipants:p,closeAllTabs:w,closeAndTabNext:y,closeTab:t,deleteTab:u,focusTab:s,focusTabEvents:x,loadFromData:B,openTab:a,receivedNewMessage:c,replaceTab:d,unminimizeTab:A}}),null);
__d("FantaReducersMessages",["CurrentUser","FantaGetMessageActions","FantaMessageActions","FantaTabActions","FantaTypeComposer","MercuryBrowserAlerts","MercuryParticipants"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FantaMessageActions").Types,h=b("FantaTabActions").Types,i=b("FantaGetMessageActions").Types;function a(a,c){switch(c.type){case g.RECEIVED_NEW_MESSAGE:c=c.message;b("MercuryBrowserAlerts").messageReceived(c);return a}return a}function c(a,b){switch(b.type){case g.COMPOSER_TEXT_UPDATE:var c=b.composer,d=b.message;b=b.threadID;var e=a.mercury.tabContents.get(b);return!e||e&&e.composer.version!==c.version?a:a.mergeIn(["mercury","tabContents",b,"composer"],{text:d})}return a}function d(a,c){switch(c.type){case h.CLOSE_TAB:case h.CLOSE_AND_TAB_NEXT:return!a.mercury.tabContents.get(c.tabID)?a:a.setIn(["mercury","tabContents",c.tabID,"composer"],new(b("FantaTypeComposer"))())}return a}function f(a,c){switch(c.type){case h.CLOSE_ALL_TABS:c=a.mercury.tabContents;c.forEach(function(c){c=c.id;a=a.setIn(["mercury","tabContents",c,"composer"],new(b("FantaTypeComposer"))())});return a}return a}function j(a,b){switch(b.type){case h.SCROLL_BOTTOM_CHANGED:var c=b.tabID,d=b.isScrolledToBottom;b=b.showUnseenMessages;var e=a.mercury.tabContents.get(c);if(!e)return a;e=e.merge({isScrolledToBottom:d,showUnseenMessages:b});a=a.setIn(["mercury","tabContents",c],e)}return a}function k(a,b){switch(b.type){case h.SHOW_UNSEEN_MESSAGES:b=b.tabID;b=a.mercury.tabContents.get(b);b&&b.showUnseenMessages()}return a}function l(a,c){__p&&__p();switch(c.type){case i.ON_GET_THREAD_RESPONSE:c=c.thread;var d=c.thread_id,e=a.mercury.tabContents.get(d);if(!e)return a;var f=null;b("CurrentUser").isWorkUser()&&c.participants&&(f=c.participants.map(b("MercuryParticipants").getOrFetch,b("MercuryParticipants")).find(function(a){return a&&a.is_coworker===!1})!==undefined);e=e.merge({thread:c,isMultiCompany:f});a=a.setIn(["mercury","tabContents",d],e);break}return a}e.exports={closeAllTabs:f,closeTab:d,composerTextUpdate:c,onGetThreadResponse:l,receivedNewMessage:a,scrollBottomChanged:j,showUnseenMessages:k}}),null);
__d("FantaReducersPreLogging",["Bootloader","FantaMessageActions","FantaTabActions","FantaTabSheetActions","MessengerSecondarySearchFunnelConstants"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FantaTabActions").Types,h=b("FantaTabSheetActions").Types,i=b("FantaMessageActions").Types;c=b("MessengerSecondarySearchFunnelConstants").TAGS;var j=c.ABANDON,k=c.SEND,l=c.ACTION;function a(a,b){__p&&__p();switch(b.type){case g.CLOSE_TAB:case g.CLOSE_AND_TAB_NEXT:case h.CLOSE_ADD_FRIENDS_SHEET:case h.CLOSE_ADD_MORE_FRIENDS_SHEET:a=m(a,b.tabID,l,j);break;case g.CLOSE_ALL_TABS:a.mercury.tabContents.forEach(function(b){a=m(a,b.id,l,j)});break;case i.SEND_GROUP_MESSAGE:a=m(a,b.threadID,l,k,!0);break;case i.SEND_HOT_LIKE:case i.SEND_MESSAGE:case i.SEND_PHOTO:case i.SEND_STICKER:a=m(a,b.threadID,l,k);break}return a}function m(a,c,d,e,f){var g=a.mercury.tabContents.get(c),h=g?g.loggingID:null,i=g?g.threadPreviewID:null;h&&b("Bootloader").loadModules(["MessengerSecondarySearchFunnelLogger"],function(b){a=a.setIn(["mercury","tabContents",c],g.merge({loggingID:null}));var j=void 0;e===k&&(f===null||f===undefined)?j=g&&g.messages.size===0:j=f;b.endFunnel(d,e,h,i?i.split(":")[1]:null,j)},"FantaReducersPreLogging");return a}e.exports={logSearchEvents:a}}),null);
__d("FantaTypeTab",["immutable"],(function(a,b,c,d,e,f){"use strict";var g;c={focusCounter:0,id:"",isHovered:!1,isMinimized:!1,openCounter:0,entryPoint:"unknown"};g=babelHelpers.inherits(a,b("immutable").Record(c));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("FantaTypeTabGroup",["FantaConst","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c={allowedRaisedTabs:b("FantaConst").DEFAULT_ALLOWED_RAISED_TABS,focusedTabID:null,tabs:b("immutable").Map({}),updatedTime:0};var h=function(a){return a.openCounter*-1},i=function(a){return a.focusCounter*-1};g=babelHelpers.inherits(a,b("immutable").Record(c));g&&g.prototype;a.prototype.getRaisedandUnraisedTabs=function(){var a=this.tabs.sortBy(i),b=a.slice(this.allowedRaisedTabs);a=a.take(this.allowedRaisedTabs).sortBy(h);return{raisedTabs:a,unraisedTabs:b}};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("isWebMessengerURI",[],(function(a,b,c,d,e,f){function a(a){return/^(\/messages)/.test(a.getPath())}e.exports=a}),null);
__d("FantaReducersTabs",["Bootloader","EventProfiler","FantaConst","FantaMessageActions","FantaTabActions","FantaTypeTab","FantaTypeTabGroup","LogHistory","MercuryThreads","PinnedConversationNubsConfig","TimeSlice","URI","isWebMessengerURI"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MercuryThreads").get(),h=b("FantaMessageActions").Types,i=b("FantaTabActions").Types,j="tab_",k=b("LogHistory").getInstance("fanta_tabs"),l=1,m=1,n=1;function a(a,c){switch(c.type){case i.OPEN_TAB:case i.OPEN_TAB_WITH_INTERSTITIAL_DATA:k.debug(c.type,JSON.stringify({id:c.tabID}));m===1&&b("EventProfiler").tagCurrentActiveInteractionsAs("FirstChatTabOpen");return r(a,c.tabID||j+n++,!0,c.entryPoint)}return a}function c(a,b){__p&&__p();switch(b.type){case i.REPLACE_TAB:var c=b.tabID,d=b.newTabID,e=a.tabGroup;e=e.tabs;e=e.get(c);k.debug(b.type,JSON.stringify({id:c,isExisting:!!e,newID:d}));if(e){b=e.id===a.tabGroup.focusedTabID;a=a.setIn(["tabGroup","tabs",d],e.merge({id:d})).deleteIn(["tabGroup","tabs",c]);return r(a,d,b,"replace_tab")}return r(a,d,!1,"replace_tab")}return a}function d(a,b){switch(b.type){case i.MINIMIZE_TAB:return s(a,b.tabID,!0)}return a}function f(a,b){switch(b.type){case i.UNMINIMIZE_TAB:return s(a,b.tabID,!1)}return a}function o(a,b){switch(b.type){case i.FOCUS_TAB:b=b.tabID;return z(a,b)}return a}function p(a,b){switch(b.type){case i.BLUR_TAB:return A(a,b.tabID)}return a}function q(a,c){__p&&__p();switch(c.type){case h.RECEIVED_NEW_MESSAGE:var d=c.tabID,e=a.tabGroup.tabs.get(d);k.debug(c.type,JSON.stringify({id:d,isOpen:!!e}));if(!e){c=function(){__p&&__p();var c=a.tabGroup.focusedTabID;a=r(a,d,!1,"message_received");var e=a.tabGroup.allowedRaisedTabs,f=a.tabGroup.getRaisedandUnraisedTabs(),g=f.raisedTabs;f=f.unraisedTabs;var h=g.count(),i=h+f.count();b("TimeSlice").guard(function(){b("Bootloader").loadModules(["FantaTabsVisibleTypedLogger"],function(a){new a().setAllowedRaisedTabs(e).setOpenTabs(i).setVisibleTabs(h).log()},"FantaReducersTabs")},"name",{propagationType:b("TimeSlice").PropagationType.ORPHAN})();g=b("URI").getNextURI();if(b("isWebMessengerURI")(g))return{v:a=s(a,d,!0)};else if(c)return{v:z(a,c)}}();if(typeof c==="object")return c.v}}return a}function r(a,c,d){var e=arguments.length<=3||arguments[3]===undefined?"unknown":arguments[3],f=a.tabGroup,g=f.tabs,h=g.get(c);!h?(h=new(b("FantaTypeTab"))({id:c,focusCounter:l,openCounter:m++,entryPoint:e}),a=a.setIn(["tabGroup","tabs",c],h)):h.isMinimized&&d&&(a=s(a,c,!1));return d?z(a,c):a}function s(a,b,c){var d=a.tabGroup;d=d.tabs.get(b);d&&(a=a.mergeIn(["tabGroup","tabs",b],{isMinimized:c}));return a}function t(a,b){__p&&__p();switch(b.type){case i.MINIMIZE_ALL_TABS:for(var b=a.tabGroup.tabs.keys(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;a=s(a,e,!0)}return a}return a}function u(a,b){switch(b.type){case i.CLOSE_TAB:case i.DELETE_TAB:var c=b.tabID;k.debug(b.type,JSON.stringify({id:c}));return w(a,c)}return a}function v(a,b){switch(b.type){case h.SEND_GROUP_MESSAGE:b=b.threadID;var c=g.isEmptyLocalThread(b);if(c)return w(a,b)}return a}function w(a,b){a=A(a,b);return a.deleteIn(["tabGroup","tabs",b])}function x(a,b){switch(b.type){case i.CLOSE_ALL_TABS:k.debug(b.type);a=A(a,a.tabGroup.focusedTabID);return a.setIn(["tabGroup","tabs"],a.tabGroup.tabs.clear())}return a}function y(a,b){switch(b.type){case i.CLOSE_AND_TAB_NEXT:k.debug(b.type,JSON.stringify({id:b.tabID}));a=w(a,b.tabID);return I(a)}return a}function z(a,b){var c=arguments.length<=2||arguments[2]===undefined?!1:arguments[2],d=a.tabGroup,e=d.tabs.get(b);e&&(a=a.mergeIn(["tabGroup","tabs",b],{focusCounter:l++}));var f=c?null:b;a=a.mergeIn(["tabGroup"],{focusedTabID:f});return a}function A(a,b){return a.tabGroup.focusedTabID===b?a.mergeIn(["tabGroup"],{focusedTabID:null}):a}function B(a,b){switch(b.type){case i.HOVERED_TAB:b=b.tabID;return D(a,b,!0)}return a}function C(a,b){switch(b.type){case i.UNHOVERED_TAB:b=b.tabID;return D(a,b,!1)}return a}function D(a,b,c){var d=a.tabGroup;d=d.tabs.get(b);d&&(a=a.mergeIn(["tabGroup","tabs",b],{isHovered:c}));return a}function E(a,c){__p&&__p();switch(c.type){case i.SET_ALLOWED_RAISED_TABS:var d=c.allowedRaisedTabs,e=a.tabGroup.allowedRaisedTabs;d!==e&&(function(){k.debug(c.type,JSON.stringify({count:d}));b("PinnedConversationNubsConfig").chatTabTypingPriority||(d=Math.max(1,d));var f=a.tabGroup.tabs.count(),g=f>d?d:f,h=d>e&&f>e,i=d<e&&f>d;(h||i)&&b("Bootloader").loadModules(["FantaTabsVisibleTypedLogger"],function(a){new a().setAllowedRaisedTabs(d).setOpenTabs(f).setVisibleTabs(g).log()},"FantaReducersTabs")})();return F(a,d)}return a}function F(a){var c=arguments.length<=1||arguments[1]===undefined?b("FantaConst").DEFAULT_ALLOWED_RAISED_TABS:arguments[1];if(c===a.tabGroup.allowedRaisedTabs)return a;b("PinnedConversationNubsConfig").chatTabTypingPriority||(c=Math.max(1,c));return a.mergeIn(["tabGroup"],{allowedRaisedTabs:c})}function G(a,c){__p&&__p();switch(c.type){case i.LOAD_FROM_DATA:var d=a.tabGroup,e=c.tabData,f=d.updatedTime;if(f>=e.updatedTime||e.updatedTime===undefined)return a;a=F(a.set("tabGroup",new(b("FantaTypeTabGroup"))()),d.allowedRaisedTabs);var g=[];e.tabs.sort(function(a,b){return a.openCounter-b.openCounter}).forEach(function(b){g.push(b.id),a=r(a,b.id,!1,"loaded_from_data"),b.isMinimized&&(a=s(a,b.id,b.isMinimized))});e.tabs.sort(function(a,b){return a.focusCounter-b.focusCounter}).forEach(function(b){a=z(a,b.id,!0)});k.debug(c.type,JSON.stringify({updatedTime:f,newerTime:e.updatedTime,opened:g}));a=e.focusedTabID?z(a,e.focusedTabID,!0):A(a)}return a}function H(a,b){switch(b.type){case i.FOCUS_NEXT_TAB:return I(a)}return a}function I(a){__p&&__p();var b=a.tabGroup.focusedTabID,c=a.tabGroup.getRaisedandUnraisedTabs();c=c.raisedTabs;var d=c.count();if(d===0)return a;else if(c.count()===1)return z(a,c.first().id);d=c.skipUntil(function(a){return a.id===b}).rest();if(d.count()===0)return z(a,c.first().id);else return z(a,d.first().id)}function J(a,b){__p&&__p();switch(b.type){case i.FOCUS_PREVIOUS_TAB:var c=a.tabGroup.focusedTabID;b=a.tabGroup.getRaisedandUnraisedTabs();b=b.raisedTabs;if(b.count()<2)return a;var d=b.reverse().skipUntil(function(a){return a.id===c}).rest();if(d.count()===0)return z(a,b.last().id);else return z(a,d.first().id)}return a}e.exports={addParticipantsToLocalGroup:v,blurTab:p,closeAllTabs:x,closeAndTabNext:y,closeTab:u,focusNextTab:H,focusPreviousTab:J,focusTab:o,hoveredTab:B,loadFromData:G,minimizAllTabs:t,minimizeTab:d,openTab:a,receivedNewMessage:q,replaceTab:c,setAllowedRaisedTabs:E,unhoveredTab:C,unminimizeTab:f}}),null);
__d("FantaTypeMercuryState",["immutable"],(function(a,b,c,d,e,f){"use strict";var g;c={tabContents:b("immutable").Map({})};g=babelHelpers.inherits(a,b("immutable").Record(c));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("FantaTypeAppState",["FantaTypeMercuryState","FantaTypeTabGroup","immutable"],(function(a,b,c,d,e,f){"use strict";var g;c={tabGroup:new(b("FantaTypeTabGroup"))(),mercury:new(b("FantaTypeMercuryState"))()};g=babelHelpers.inherits(a,b("immutable").Record(c));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("FantaAppStore",["FantaComposeViewReducers","FantaDispatcher","FantaReducersCookie","FantaReducersDockCalculator","FantaReducersLogging","FantaReducersMercury","FantaReducersMessages","FantaReducersPreLogging","FantaReducersTabs","FantaTypeAppState","FluxReduceStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=[].concat(Object.values(b("FantaReducersPreLogging")),Object.values(b("FantaReducersTabs")),Object.values(b("FantaReducersMercury")),Object.values(b("FantaReducersMessages")),Object.values(b("FantaReducersDockCalculator")),Object.values(b("FantaReducersCookie")),Object.values(b("FantaComposeViewReducers")),Object.values(b("FantaReducersLogging")));c=babelHelpers.inherits(a,b("FluxReduceStore"));g=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),f=0;f<c;f++)d[f]=arguments[f];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.__moduleID=e.id,b}a.prototype.getInitialState=function(){return new(b("FantaTypeAppState"))()};a.prototype.ignoreReducer=function(a){var b=Object.values(a);h=h.filter(function(a){return!b.find(function(b){return b===a})})};a.prototype.addReducers=function(a){this.ignoreReducer(a),h=h.concat(Object.values(a))};a.prototype.reduce=function(a,b){return h.reduce(function(a,c){return c(a,b)},a)};d=new a(b("FantaDispatcher"));e.exports=d}),null);
__d("FantaCookieUtil",["CurrentUser","FantaConst","MercuryIDs","MercuryThreads","MessengerDiscoveryEntryPoint","MercuryMessages","WorkModeConfig","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MercuryThreads").get();a={convertCookieData:function(a,b,c){__p&&__p();var d={tabs:[],focusedTabID:null,updatedTime:0,interstitialData:c};c=[];var e=this._getCookieKeys();a=a||{};a[e.tabs]&&(c=a[e.tabs]);c.forEach(function(a){d.tabs.push({id:a.i,isMinimized:!a.r,openCounter:a.o,focusCounter:a.f})});if(b)for(var c=b.tabs.values(),b=Array.isArray(c),f=0,c=b?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(b){if(f>=c.length)break;h=c[f++]}else{f=c.next();if(f.done)break;h=f.value}h=h;g.isEmptyLocalThread(h.id)&&d.tabs.push({id:h.id,isMinimized:h.isMinimized,openCounter:h.openCounter,focusCounter:h.focusCounter})}d.focusedTabID=a[e.focusedTabID];d.updatedTime=a[e.updatedTime];return d},createCookieData:function(a,c){__p&&__p();var d=[],e=this._getCookieKeys();if(c[e.updatedTime]>a.updatedTime)return c;for(var f=a.tabs.values(),g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;!b("MercuryIDs").isLocalThread(i.id)&&!this._shouldDisableForCookie(i.id,i.entryPoint)&&d.push({i:i.id,r:i.isMinimized?undefined:1,o:i.openCounter,f:i.focusCounter})}c[e.tabs]=d;c[e.focusedTabID]=a.focusedTabID;c[e.updatedTime]=a.updatedTime;return c},_shouldDisableForCookie:function(a,c){if(!c.includes(b("MessengerDiscoveryEntryPoint").FB_PAGE_USER_MESSAGE_PROMPT))return!1;c=b("MercuryMessages").getForFBID(b("CurrentUser").getID());c=c.getThreadMessagesRangeNow(a,0,1)[0];return c===undefined&&b("gkx")("AT5yvaIVlO2OHqFIDWWRhRABINJAcxCp1ro66bHRcO0eEaLcqpagLVIr-zqdMYZpNoEnM0j8G8evTFI0zml2LudFjHJmYlaU_Y6yQ26Iu3tDvgUsS-yP2Aotk3FJ2AWnq4g")},_getCookieKeys:function(){var a=b("WorkModeConfig").is_work_user;return{tabs:a?b("FantaConst").cookieIDs.WORK_COOKIE_ID:b("FantaConst").cookieIDs.PERSONAL_COOKIE_ID,focusedTabID:a?b("FantaConst").cookieIDs.WORK_FOCUS_COOKIE_ID:b("FantaConst").cookieIDs.PERSONAL_FOCUS_COOKIE_ID,updatedTime:a?b("FantaConst").cookieIDs.WORK_TIME_COOKIE_ID:b("FantaConst").cookieIDs.PERSONAL_TIME_COOKIE_ID}}};e.exports=a}),null);
__d("FantaMercuryThreadEventsBootloaded",["Bootloader","MercuryThreadInformer","MercuryThreads","MercuryViewer","WorkplaceChatHelper"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MercuryThreadInformer").get(),h=b("MercuryThreads").get();a={onMessagesReceived:function(a){__p&&__p();if(b("WorkplaceChatHelper").suppressChatIfActiveOnDesktop())return;g.subscribe("messages-received",function(c,d){__p&&__p();c=function(c){__p&&__p();var e,f=d[c],g=function(d){var e=f[d];if(e.author!=b("MercuryViewer").getID()){if(!e.is_unread)return"continue";h.getThreadMeta(c,function(d){b("Bootloader").loadModules(["ChatTabPolicy"],function(b){b.messageIsAllowed(d,e,function(){a(c,e)})},"FantaMercuryThreadEventsBootloaded")})}};for(var i=0;i<f.length;i++){var e=g(i);if(e==="continue")continue}};for(var e in d)c(e)})}};e.exports=a}),null);
__d("FantaTabMainPlaceholder.react",["cx","React","XUISpinner.react"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return b("React").createElement("div",{className:"_59v1"},b("React").createElement("div",{className:"_5qi9 _5qib"},b("React").createElement("div",{className:"_3_9e _s0f _50mz _50m_ fbNub _50-v opened _27_3"},b("React").createElement("div",{className:"fbNubFlyout fbDockChatTabFlyout uiContextualLayerParent"},b("React").createElement("div",{className:"fbNubFlyoutOuter"},b("React").createElement("div",{className:"fbNubFlyoutInner"},b("React").createElement("div",{className:"_5-kq"},b("React").createElement(b("XUISpinner.react"),null))))))))};e.exports=a}),null);
__d("FantaTabViewportManager",["Arbiter","DockTabsViewportCalculator","DockTabsViewportFantaTabUtils","FantaTabActions","immutable","ifRequired","isWebMessengerURI","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){__p&&__p();var c=b("DockTabsViewportCalculator").getInstance(a);if(!c)return;c.registerFantaTabCallbacks({fantaTabModelStateGetter:function(){var a=b("immutable").Map({});b("ifRequired")("FantaAppStore",function(b){a=b.getState().tabGroup.tabs});return a},onAvailableWidthChanged:function(a){b("setImmediate")(function(){b("FantaTabActions").setAllowedRaisedTabs(b("DockTabsViewportFantaTabUtils").getTabCountToFitWidth(a))})}});b("Arbiter").subscribe("FantaReducersDockCalculator/shouldRecalculate",function(){c.forceRecalculateChatTabs()});c.forceRecalculateFBDockWidth();b("Arbiter").subscribe("page_transition",function(a,c){b("isWebMessengerURI")(c.uri)&&b("setImmediate")(function(){return b("FantaTabActions").minimizeAllTabs()})})}e.exports={init:a}}),null);
__d("HotLikeSound",["MercurySoundsConfig","SoundPlayer","StickerConstants"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=[b("MercurySoundsConfig").hot_like_grow_mp3_url,b("MercurySoundsConfig").hot_like_grow_ogg_url],h=[b("MercurySoundsConfig").hot_like_pop_mp3_url,b("MercurySoundsConfig").hot_like_pop_ogg_url],i=[b("MercurySoundsConfig").hot_like_outgoing_small_mp3_url,b("MercurySoundsConfig").hot_like_outgoing_small_ogg_url],j=[b("MercurySoundsConfig").hot_like_outgoing_medium_mp3_url,b("MercurySoundsConfig").hot_like_outgoing_medium_ogg_url],k=[b("MercurySoundsConfig").hot_like_outgoing_large_mp3_url,b("MercurySoundsConfig").hot_like_outgoing_large_ogg_url],l=function(){return!1};a={setCheckSoundEnabledFunc:function(a){l=a},start:function(){this._play(g)},stop:function(){b("SoundPlayer").stop(g)},pop:function(){this.stop(),this._play(h)},snap:function(a){this.stop(),a===b("StickerConstants").HOT_LIKE_SMALL_STICKER_ID&&this._play(i),a===b("StickerConstants").HOT_LIKE_MEDIUM_STICKER_ID&&this._play(j),a===b("StickerConstants").HOT_LIKE_LARGE_STICKER_ID&&this._play(k)},_play:function(a){l()&&b("SoundPlayer").play(a)}};e.exports=a}),null);
__d("MercuryDeliveryState",["MercuryConfig","MercuryIDs","MercuryServerRequests","MercurySingletonProvider","MercuryThreadIDMap","MercuryThreadInformer","PresencePrivacy","UserActivity","debounceAcrossTransitions","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MercuryConfig").delivery_timeout||12e4;a.getForFBID=function(a){return h.getForFBID(a)};a.get=function(){return h.get()};function a(a){this.$8=function(){if(this.$5.length===0&&Object.keys(this.$6).length===0)return;var a=this.$5.map(function(a){return a.message_id});a&&this.$2.sendDeliveryReceipts(a,this.$6);this.$6={};this.$5=[]}.bind(this),this.$1=a,this.$2=b("MercuryServerRequests").getForFBID(this.$1),this.$3=b("MercuryThreadInformer").getForFBID(this.$1),this.$4=b("MercuryThreadIDMap").getForFBID(this.$1),this.$5=[],this.$6={},this.$3.subscribe("messages-received",this.$7.bind(this)),b("UserActivity").subscribe(b("debounceAcrossTransitions")(this.$8,300,this))}a.prototype.$7=function(a,c){for(var d in c){a=c[d];a.forEach(function(a){this.$9(a)&&(this.$5.push(a),this.$4.getServerIDFromClientID(d,function(b){this.$6[b]||(this.$6[b]=[]),this.$6[b].push(a.message_id)}.bind(this)))}.bind(this))}(b("UserActivity").isActive(g)||b("gkx")("AT6QldQ637XMvCyugHEhjQqDDf2-wtP50HTiWZ1Ww9U3TKMTy-LCSwNJff4SK8McDFogXyIPPHKCxhkz9mFRLCX-m6fUBuF8qkM5EElKo4EzDw"))&&this.$8()};a.prototype.$9=function(a){var c=a.author?b("MercuryIDs").getUserIDFromParticipantID(a.author):null;if(c===this.$1)return!1;return!a.is_unread?!1:!0};var h=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercuryDelayedDispatcher",["MercuryDispatcher","MercuryServerPayloadPreprocessor","MercuryServerRequests","MercurySingletonProvider","MercuryThreadIDMap"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){this.$1=a,this.$2=[],this.$3=b("MercuryThreadIDMap").getForFBID(this.$1),this.$4=b("MercuryDispatcher").getForFBID(this.$1),this.$5=b("MercuryServerRequests").getForFBID(this.$1),this.$6=b("MercuryServerPayloadPreprocessor").getForFBID(this.$1),this.$4.subscribe("model-update-completed",function(a,b){return this.$7()}.bind(this))}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};a.prototype.handleUpdateWaitForThread=function(a,b){var c=this.$3.getClientIDFromServerIDNow(b);if(c){this.$8(a);return}this.$3.getClientIDFromServerID(b,function(){return this.$2.push({thread_fbid:b,payload:a})}.bind(this));this.$5.ensureThreadIsFetched(b)};a.prototype.$7=function(){if(this.$2&&this.$2.length){var a=this.$2.shift(),b=a.thread_fbid;a=a.payload;this.handleUpdateWaitForThread(a,b)}};a.prototype.$8=function(a){a.from_client?this.$4.handleUpdate(a):this.$6.handleUpdate(a)};var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercurySyncChannelMonitor",["Arbiter","ChannelConstants","CurrentUser","MercurySingletonProvider","MercurySyncFakeDFFSender"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){this.handleAwfulChannelEvent=function(){if(!b("CurrentUser").isLoggedInNow()){this.killSubscriptions();return}b("MercurySyncFakeDFFSender").getForFBID(this.$1).sendGlobalDFF()}.bind(this),this.$1=a,this.$2=!1}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};a.prototype.setupSubscriptions=function(){this.$2||(this.$4=b("Arbiter").subscribe(b("ChannelConstants").JUMPSTART,this.handleAwfulChannelEvent),this.$3=b("Arbiter").subscribe(b("ChannelConstants").THROTTLED,this.handleAwfulChannelEvent),this.$2=!0)};a.prototype.killSubscriptions=function(){this.$2&&(b("Arbiter").unsubscribe(this.$4),b("Arbiter").unsubscribe(this.$3),this.$2=!1)};var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercuryMessageCustomizations",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,b){a=a.customizations;if(!a)return null;a=a.filter(function(a){return a.customization_type===b});return a.length>0?a[0].customization_value:null}function b(a){var b=JSON.parse(a),c=[];Object.keys(b).forEach(function(a){c.push({customization_type:a,customization_value:b[a]})});return c}e.exports={getCustomizationValue:a,parseCustomizations:b}}),null);
__d("MercuryProfileRanges",["idx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){return!a.id&&a.i?{id:a.i,offset:a.o,length:a.l}:a}e.exports={extractFromDelta:function(a){a=(a=a)!=null?(a=a.data)!=null?a.prng:a:a;if(!a)return undefined;var b=[];try{b=JSON.parse(a);if(b.length>0)return b.map(g)}catch(a){}return b}}}),null);
__d("MessageThreadReadStateEffect",[],(function(a,b,c,d,e,f){"use strict";var g={MARK_READ:1,MARK_UNREAD:2,KEEP_AS_IS:3};a=function(a,b){var c=b.messageMetadata.skipBumpThread;a=a!==b.messageMetadata.actorFbId?g.MARK_UNREAD:g.KEEP_AS_IS;c&&(a=g.KEEP_AS_IS);return b.messageMetadata.threadReadStateEffect?b.messageMetadata.threadReadStateEffect:a};e.exports={MessageThreadReadStateEffectType:g,extractThreadStateEffectFromDelta:a}}),null);
__d("MessengerRealtimeAttachmentTransformer.bs",["MessengerMessageTransformer.bs","MessengerAttachmentTransformer.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d){var e=b("MessengerMessageTransformer.bs").unsafeCastBlobAttachments(c),f=c.extensible_attachment,g;if(f==null)g=null;else{var h=f.story_attachment;g={legacy_attachment_id:f.legacy_attachment_id,story_attachment:h==null?null:b("MessengerMessageTransformer.bs").unsafeCastExtensibleAttachment(h)}}return b("MessengerAttachmentTransformer.bs").transformAttachment(a,{extensible_attachment:g,blob_attachments:e,sticker:c.sticker},d)}f.transform=a}),null);
__d("MercurySyncNewMessageTransformer",["FBIDCheck","IrisProtocolMessageLifetime","MercuryActionType","MercuryIDs","MercuryMessageCustomizations","MercuryProfileRanges","MessagingTag","PageCommItemStatus","MessageThreadReadStateEffect","MessengerRealtimeAttachmentTransformer.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MessageThreadReadStateEffect").MessageThreadReadStateEffectType,h=b("MessageThreadReadStateEffect").extractThreadStateEffectFromDelta,i=function(a){var b={};try{b=JSON.parse(a)}catch(a){}return b};function a(a,c){__p&&__p();var d=parseInt(c.messageMetadata.timestamp,10),e=c.messageMetadata.skipBumpThread,f=h(a,c),j=f===g.MARK_UNREAD&&a!==c.messageMetadata.actorFbId,k=[];c.attachments&&(k=c.attachments.map(function(c){c=c.mercury;var d=c.extensible_attachment,e=c.blob_attachment;c=c.sticker_attachment;if(!d&&!e&&!c)return null;var f=b("FBIDCheck").isUser_deprecated(a);[];d?d=b("MessengerRealtimeAttachmentTransformer.bs").transform(a,{extensible_attachment:d},f):e?d=b("MessengerRealtimeAttachmentTransformer.bs").transform(a,{blob_attachments:[e]},f):d=b("MessengerRealtimeAttachmentTransformer.bs").transform(a,{sticker:c});return d.length>0?d[0]:null}));var l=!b("FBIDCheck").isUser_deprecated(a);k=k.filter(Boolean);var m=c.messageMetadata.tags?c.messageMetadata.tags[0]:undefined,n=null;if(c.data&&c.data.adminSignatureCreatorID){var o=c.data;n={creatorID:o.adminSignatureCreatorID||null,creatorName:o.adminSignatureCreatorName||null,creatorType:o.adminSignatureCreatorType||null,labelType:o.adminSignatureLabelType||null,pageID:o.adminSignaturePageID||null,profileURI:o.adminSignatureProfileURI||null}}return{message_id:c.messageMetadata.messageId,threading_id:null,offline_threading_id:c.messageMetadata.offlineThreadingId,author:b("MercuryIDs").getParticipantIDFromUserID(c.messageMetadata.actorFbId),author_email:c.messageMetadata.actorFbId+"@facebook.com",ephemeral_ttl_mode:c.ttl?b("IrisProtocolMessageLifetime")[c.ttl]:0,timestamp:d,is_unread:j,is_filtered_content:!1,is_filtered_content_bh:!1,is_filtered_content_account:!1,is_filtered_content_quasar:!1,is_filtered_content_invalid_app:!1,source:m,tags:c.messageMetadata.tags,is_spoof_warning:!1,folder:b("MessagingTag").INBOX,thread_fbid:c.messageMetadata.threadKey.threadFbId,other_user_fbid:c.messageMetadata.threadKey.otherUserFbId,body:c.body!==undefined?c.body:"",html_body:null,subject:null,has_attachment:k.length>0,attachments:k,ranges:undefined,thread_id:null,action_type:b("MercuryActionType").USER_GENERATED_MESSAGE,is_from_iris:!0,is_sponsored:!!(c.data&&c.data.is_sponsored&&c.data.is_sponsored==="true")||!!(c.untypedData&&c.untypedData.is_sponsored&&c.untypedData.is_sponsored==="true"),commerce_message_type:c.data?c.data.commerce_message_type:null,customizations:c.data&&c.data.customization?b("MercuryMessageCustomizations").parseCustomizations(c.data.customization):null,platform_xmd:c.data&&c.data.platform_xmd?c.data.platform_xmd:null,profile_ranges:b("MercuryProfileRanges").extractFromDelta(c),message_source:c.data&&c.data.message_source_data?i(c.data.message_source_data).message_source:null,skip_bump_thread:e,thread_read_state_effect:f,montage_reply_data:c.data&&c.data.montage_reply_data?i(c.data.montage_reply_data):null,meta_ranges:c.data&&c.data.meta_ranges?i(c.data.meta_ranges):null,creator_info:n,comm_status:l?b("PageCommItemStatus").TODO:null}}e.exports={transform:a}}),null);
__d("MercurySyncAdminTextMessageTransformer",["MercuryActionType","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function(a,b,c,d,e,f){"use strict";function a(a,c){a=b("MercurySyncNewMessageTransformer").transform(a,c);a.action_type=b("MercuryActionType").LOG_MESSAGE;a.log_message_body=c.messageMetadata.adminText;a.log_message_data={message_type:c.type,untypedData:c.untypedData};a.log_message_type=b("MercuryLogMessageType").GENERIC_ADMIN_TEXT;return a}e.exports={transform:a}}),null);
__d("ClientSyncProtocol_GroupsSyncAction",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({OPT_IN:0,OPT_OUT:1})}),null);
__d("LiveLocationStopReason",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({EXPIRED:1,CANCELED:2,ARRIVED:3})}),null);
__d("MercurySyncClientPayloadTransformer",["ClientSyncProtocol_GroupsSyncAction","DateConsts","LiveLocationStopReason","MercuryActionType","MercuryIDs","MercurySyncNewMessageTransformer","MessageLiveLocationClientSyncProtocolStopReason","MessengerGroupsSyncStatus","PageCommItemStatus","keyMirror"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("keyMirror")(b("LiveLocationStopReason")),h=8;function a(a,b){__p&&__p();a=a.payload;a=JSON.parse(String.fromCharCode.apply(null,a));a=a&&a.deltas;a=a[0];if(a.deltaMessageReaction)return n(a.deltaMessageReaction);else if(a.liveLocationData)return p(a.liveLocationData);else if(a.deltaUpdateGroupEventRSVPStatus){var c=a.deltaUpdateGroupEventRSVPStatus;return o(c)}else if(a.deltaPageThreadFollowUpData)return r(a.deltaPageThreadFollowUpData);else if(a.deltaChangeViewerStatus)return l(a.deltaChangeViewerStatus,b);else if(a.deltaMontageDirectExpire)return m(a.deltaMontageDirectExpire);else if(a.deltaMessageReply)return i(a.deltaMessageReply,b);else if(a.deltaUpdateGroupsSyncStatus)return j(a.deltaUpdateGroupsSyncStatus);else if(a.deltaUpdateGroupsSyncMetadata)return k(a.deltaUpdateGroupsSyncMetadata);else return q(a)}function i(a,c){var d=a.message;a=a.repliedToMessage;d=b("MercurySyncNewMessageTransformer").transform(c,d);if(a){c=b("MercurySyncNewMessageTransformer").transform(c,a);d.replied_to_message=c}return d}function j(a){var c=a.threadKey,d=a.actorFbid;a=a.groupsSyncStatus;c=c.threadFbId||c.otherUserFbId;if(!c)return null;a=b("MessengerGroupsSyncStatus")[a];return{action_type:b("MercuryActionType").GROUPS_SYNC_STATUS_CHANGED,thread_fbid:c.toString(),actor_fbid:d.toString(),groups_sync_status_string:a}}function k(a){__p&&__p();var c=a.threadKey,d=a.actorFbid,e=a.syncAction,f=a.sourceSurface;a=a.syncedFbGroupId;c=c.threadFbId||c.otherUserFbId;if(!c)return null;var g=void 0;switch(e){case b("ClientSyncProtocol_GroupsSyncAction").OPT_IN:g=b("MessengerGroupsSyncStatus").OPT_IN;break;case b("ClientSyncProtocol_GroupsSyncAction").OPT_OUT:g=b("MessengerGroupsSyncStatus").OPT_OUT;break;default:return null}return{action_type:b("MercuryActionType").GROUPS_SYNC_METADATA_UPDATE,thread_fbid:c.toString(),actor_fbid:d.toString(),groups_sync_action:g,source_surface:f,fb_group_id:a.toString()}}function l(a,c){var d=a.actorFbid,e=a.canViewerReply,f=a.reason;a=a.threadKey;if(!d)return null;var g=d.toString();g=b("MercuryIDs").getParticipantIDFromUserID(g===c?a.otherUserFbId:c);return{action_type:b("MercuryActionType").BLOCK_STATUS_CHANGED,actorFbid:d,canViewerReply:e,reason:f,message_blocked_ids:[g],other_user_fbid:a.otherUserFbId.toString()}}function m(a){var c=a.threadKey.threadFbId||a.threadKey.otherUserFbId;return{action_type:b("MercuryActionType").MONTAGE_DIRECT_EXPIRE,messageId:a.messageId,timestamp:a.timestamp,thread_fbid:c.toString(),keep_expiry_timestamp:a.keepExpiryTimestamp}}function n(a){var c=a.messageId,d=a.offlineThreadingId,e=a.reaction,f=a.senderId,g=a.userId;a=a.threadKey.threadFbId||a.threadKey.otherUserFbId;return{action_type:b("MercuryActionType").REACTION_UPDATE,messageId:c,offlineThreadingId:d,reaction:e,senderId:f,thread_fbid:a.toString(),userId:g}}function o(a){var c=a.threadKey&&a.threadKey.threadFbId;if(!c)return null;var d=a.actorFbId;a=a.rsvpStatus;return!d?null:{action_type:b("MercuryActionType").EVENT_RSVP_CHANGED,thread_fbid:c.toString(),actor_fbid:d.toString(),rsvp_status:a}}function p(a){__p&&__p();var c=a.threadKey;if(!c)return null;c=c.threadFbId||c.otherUserFbId;if(!c)return null;if(!a.messageLiveLocations||a.messageLiveLocations.length!==1)return null;a=a.messageLiveLocations[0];var d=a.expirationTime,e=a.stopReason!=null||Date.now()/b("DateConsts").MS_PER_SEC>d,f=function(a){return a/Math.pow(10,h)},i=a.coordinate?{latitude:f(a.coordinate.latitude),longitude:f(a.coordinate.longitude)}:null,j=null;a.destination&&(j={latitude:f(a.destination.latitude),longitude:f(a.destination.longitude),label:a.destination.label});f=null;switch(a.stopReason){case b("MessageLiveLocationClientSyncProtocolStopReason").EXPIRED:f=g.EXPIRED;break;case b("MessageLiveLocationClientSyncProtocolStopReason").CANCELED:f=g.CANCELED;break;case b("MessageLiveLocationClientSyncProtocolStopReason").ARRIVED:f=g.ARRIVED;break}return{action_type:b("MercuryActionType").LIVE_LOCATION_UPDATE,thread_fbid:c.toString(),messageId:a.messageId,liveLocation:{live_location_id:a.id.toString(),is_expired:e,expiration_time:d,sender:{id:a.senderId.toString()},coordinate:i,location_title:a.locationTitle,sender_destination:j,stop_reason:f}}}function q(a){a=a&&a.deltaPaymentPinProtectionStatusData;var c=a&&a.threadKey&&a.threadKey.otherUserFbId;a=a&&a.isPinProtected;if(!c)return null;c=c.toString();return{action_type:b("MercuryActionType").IS_PIN_PROTECTED,thread_fbid:c,is_pin_protected:a}}function r(a){var c=a.threadKey.otherUserFbId;return{action_type:b("MercuryActionType").UPDATE_COMM_STATUS,comm_status:a.isFollowUp?b("PageCommItemStatus").FOLLOW_UP:b("PageCommItemStatus").TODO,thread_fbid:c.toString()}}e.exports={transform:a}}),null);
__d("MercurySyncDeliveryReceiptTransformer",[],(function(a,b,c,d,e,f){"use strict";function a(a){return{delivery_receipts:[{other_user_fbid:a.threadKey.otherUserFbId?a.threadKey.otherUserFbId:"",thread_fbid:a.threadKey.threadFbId?a.threadKey.threadFbId:"",time:parseInt(a.deliveredWatermarkTimestampMs,10)}]}}e.exports={transform:a}}),null);
__d("MercurySyncMarkFolderChangeTransformer",["MercuryActionType","MessagingTag"],(function(a,b,c,d,e,f){"use strict";function a(a){return{action_type:b("MercuryActionType").CHANGE_FOLDER,other_user_fbid:a.threadKey.otherUserFbId,new_folder:b("MessagingTag").IRIS_MAPPING[a.folder]}}e.exports={transform:a}}),null);
__d("MercurySyncMarkFolderSeenTransformer",["MercuryGlobalActionType","MessagingTag"],(function(a,b,c,d,e,f){"use strict";function a(a){return a.folders.map(function(c){return{action_type:b("MercuryGlobalActionType").MARK_ALL_SEEN,folder:b("MessagingTag").IRIS_MAPPING[c],timestamp:parseInt(a.timestamp,10)}})}e.exports={transform:a}}),null);
__d("MercurySyncMarkReadTransformer",["MercuryActionType","MercuryGlobalActionType","MessagingTag"],(function(a,b,c,d,e,f){"use strict";function a(a){return a.folders&&a.folders.length>0?a.folders.map(function(c){return{action_type:b("MercuryGlobalActionType").MARK_ALL_READ,action_id:null,folder:b("MessagingTag").IRIS_MAPPING[c],timestamp:parseInt(a.watermarkTimestamp,10)}}):a.threadKeys.map(function(c){return{action_type:b("MercuryActionType").CHANGE_READ_STATUS,other_user_fbid:c.otherUserFbId,thread_fbid:c.threadFbId,mark_as_read:!0,timestamp:parseInt(a.watermarkTimestamp,10),folder:b("MessagingTag").INBOX}})}e.exports={transform:a}}),null);
__d("MercurySyncMarkUnreadTransformer",["MercuryActionType","MessagingTag"],(function(a,b,c,d,e,f){"use strict";function a(a){return a.threadKeys.map(function(c){return{action_type:b("MercuryActionType").CHANGE_READ_STATUS,other_user_fbid:c.otherUserFbId,thread_fbid:c.threadFbId,mark_as_read:!1,timestamp:parseInt(a.watermarkTimestamp,10),folder:b("MessagingTag").INBOX}})}e.exports={transform:a}}),null);
__d("MercurySyncMessageDeleteTransformer",["MercuryActionType"],(function(a,b,c,d,e,f){"use strict";function a(a){return{action_type:b("MercuryActionType").DELETE_MESSAGES,message_ids:a.messageIds,other_user_fbid:a.threadKey.otherUserFbId,thread_fbid:a.threadKey.threadFbId}}e.exports={transform:a}}),null);
__d("PagesMessagingEventType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({FLAG:1,CREATE_ADMIN_NOTE:2,PRIORITY_UPDATE:3})}),null);
__d("MercurySyncPagesManagerEventTransformer",["MercuryActionType","PagesMessagingEventType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){var c=JSON.parse(a.jsonBlob),d=c&&c.type;if(!d)return undefined;switch(d){case b("PagesMessagingEventType").FLAG:d=!!(c&&c.flagData&&c.flagData.state);c={action_type:b("MercuryActionType").CHANGE_FLAG,mark_as_flag:d,other_user_fbid:a.threadKey.otherUserFbId,thread_fbid:a.threadKey.threadFbId};return c;default:return undefined}}e.exports={transform:a}}),null);
__d("MercurySyncParticipantLeftGroupThreadTransformer",["MercuryActionType","MercuryIDs","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function(a,b,c,d,e,f){"use strict";function a(a,c){a=b("MercurySyncNewMessageTransformer").transform(a,c);a.action_type=b("MercuryActionType").LOG_MESSAGE;a.log_message_body=c.messageMetadata.adminText;a.log_message_data={removed_participants:[b("MercuryIDs").getParticipantIDFromUserID(c.leftParticipantFbId)]};a.log_message_type=b("MercuryLogMessageType").UNSUBSCRIBE;return a}e.exports={transform:a}}),null);
__d("MercurySyncParticipantsAddedToGroupThreadTransformer",["MercuryActionType","MercuryIDs","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){a=b("MercurySyncNewMessageTransformer").transform(a,c);a.action_type=b("MercuryActionType").LOG_MESSAGE;a.log_message_body=c.messageMetadata.adminText;a.log_message_data={added_participants:c.addedParticipants.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a.userFbId)})};a.log_message_type=b("MercuryLogMessageType").SUBSCRIBE;return a}e.exports={transform:a}}),null);
__d("MercurySyncRTCEventLogTransformer",["MercuryActionType","MercuryIDs","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){var d=b("MercurySyncNewMessageTransformer").transform(a,c),e=c.messageMetadata.actorFbId;a=e===a?c.messageMetadata.threadKey.otherUserFbId:a;var f=c.eventType==="VOICE_EVENT"?b("MercuryLogMessageType").PHONE_CALL:b("MercuryLogMessageType").VIDEO_CALL;d.action_type=b("MercuryActionType").LOG_MESSAGE;d.log_message_body=c.messageMetadata.adminText;d.log_message_data={answered:c.duration>0,callee:b("MercuryIDs").getParticipantIDFromUserID(a),caller:b("MercuryIDs").getParticipantIDFromUserID(e)};d.log_message_type=f;return d}e.exports={transform:a}}),null);
__d("MercurySyncReadReceiptTransformer",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b={watermark:parseInt(a.watermarkTimestampMs,10),action:parseInt(a.actionTimestampMs,10)},c=a.threadKey.otherUserFbId||a.actorFbId;a=a.threadKey.otherUserFbId||a.threadKey.threadFbId;var d={roger:{}};d.roger[a]={};d.roger[a][c]=b;return d}e.exports={transform:a}}),null);
__d("MercurySyncReplaceMessageTransformer",["MercuryActionType","MercurySyncNewMessageTransformer"],(function(a,b,c,d,e,f){"use strict";function a(a,c){c=Object.assign({},c.newMessage,c);return Object.assign(b("MercurySyncNewMessageTransformer").transform(a,c),{action_type:b("MercuryActionType").REPLACE_MESSAGE,replaced_message_id:c.replacedMessageId})}e.exports={transform:a}}),null);
__d("MercurySyncRtcCallDataTransformer",["MercuryActionType"],(function(a,b,c,d,e,f){"use strict";function a(a){var c=a.messageMetadata.threadKey&&a.messageMetadata.threadKey.threadFbId?a.messageMetadata.threadKey.threadFbId.toString():undefined,d=a.initiator&&a.initiator.userFbId?a.initiator.userFbId.toString():undefined;return{action_type:b("MercuryActionType").UPDATE_RTC_CALL_DATA,thread_fbid:c,call_state:a.callState,server_info_data:a.serverInfoData,initiator_fbid:d}}e.exports={transform:a}}),null);
__d("MessagingThreadAction",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ACTION_INVALID:"ACTION_INVALID",ACTION_ARCHIVED:"ACTION_ARCHIVED",ACTION_UNARCHIVED:"ACTION_UNARCHIVED"})}),null);
__d("MercurySyncThreadActionTransformer",["MercuryActionType","MessagingThreadAction"],(function(a,b,c,d,e,f){"use strict";function a(a){a={action_type:b("MercuryActionType").CHANGE_ARCHIVED_STATUS,thread_fbid:a.threadKey.threadFbId,other_user_fbid:a.threadKey.otherUserFbId,archived:a.action===b("MessagingThreadAction").ACTION_ARCHIVED};return a}e.exports={transform:a}}),null);
__d("MercurySyncThreadAdminsAddToGroupTransformer",["MercuryActionType"],(function(a,b,c,d,e,f){"use strict";function a(a){return{action_type:b("MercuryActionType").ADD_GROUP_ADMINS,action_id:null,thread_fbid:a.messageMetadata.threadKey.threadFbId,added_admin_ids:a.addedAdmins.map(function(a){return a.userFbId})}}e.exports={transform:a}}),null);
__d("MercurySyncThreadAdminsRemovedFromGroupTransformer",["MercuryActionType"],(function(a,b,c,d,e,f){"use strict";function a(a){return{action_type:b("MercuryActionType").REMOVE_GROUP_ADMINS,action_id:null,thread_fbid:a.messageMetadata.threadKey.threadFbId,removed_admin_ids:a.removedAdminFbIds}}e.exports={transform:a}}),null);
__d("MercurySyncThreadApprovalModeTransformer",["MercuryActionType","MessengerApprovalModeTypes"],(function(a,b,c,d,e,f){"use strict";function a(a){return{action_type:b("MercuryActionType").APPROVAL_MODE,action_id:null,thread_fbid:a.messageMetadata.threadKey.threadFbId,approval_mode:b("MessengerApprovalModeTypes")[a.mode]}}e.exports={transform:a}}),null);
__d("MessengerApprovalQueueTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({REQUESTED:"REQUESTED",REMOVED:"REMOVED"})}),null);
__d("MessengerGroupRequestSource",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ADD:0,JOIN_THROUGH_LINK:1})}),null);
__d("MercurySyncThreadApprovalQueueTransformer",["MercuryActionType","MercuryIDs","MessengerApprovalQueueTypes","MessengerGroupRequestSource"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){if(a===null||a===undefined)return null;switch(a){case"ADD":return b("MessengerGroupRequestSource").ADD;case"JOIN_THROUGH_LINK":return b("MessengerGroupRequestSource").JOIN_THROUGH_LINK;default:return null}}function a(a){if(a.inviterFbId)return{action_type:b("MercuryActionType").APPROVAL_QUEUE,action_id:null,thread_fbid:a.messageMetadata.threadKey.threadFbId,removed_group_id:a.action===b("MessengerApprovalQueueTypes").REMOVED?a.recipientFbId:null,added_group_id:a.action===b("MessengerApprovalQueueTypes").REQUESTED?{requester:{id:a.recipientFbId},inviter:{id:a.inviterFbId},request_source:g(a.requestSource),request_timestamp:a.requestTimestamp}:null};var c=b("MercuryIDs").getParticipantIDFromUserID(a.recipientFbId);return{action_type:b("MercuryActionType").APPROVAL_QUEUE,action_id:null,thread_fbid:a.messageMetadata.threadKey.threadFbId,removed_id:a.action===b("MessengerApprovalQueueTypes").REMOVED?c:null,added_id:a.action===b("MessengerApprovalQueueTypes").REQUESTED?c:null}}e.exports={transform:a}}),null);
__d("MercurySyncThreadDeleteTransformer",["MercuryActionType"],(function(a,b,c,d,e,f){"use strict";function a(a){return a.threadKeys.map(function(a){return{action_type:b("MercuryActionType").DELETE_THREAD,other_user_fbid:a.otherUserFbId,thread_fbid:a.threadFbId}})}e.exports={transform:a}}),null);
__d("MercurySyncThreadJoinableModeTransformer",["MercuryActionType","MessengerJoinableModeType"],(function(a,b,c,d,e,f){"use strict";function a(a){return{action_type:b("MercuryActionType").JOINABLE_MODE,action_id:null,thread_fbid:a.messageMetadata.threadKey.threadFbId,joinable_mode:{mode:b("MessengerJoinableModeType")[a.mode],link:a.link}}}e.exports={transform:a}}),null);
__d("MercurySyncThreadMuteSettingsTransformer",["MercuryActionType"],(function(a,b,c,d,e,f){"use strict";function a(a){a={action_type:b("MercuryActionType").CHANGE_MUTE_SETTINGS,thread_fbid:a.threadKey.threadFbId,other_user_fbid:a.threadKey.otherUserFbId,mute_until:parseInt(a.expireTime,10)};return a}e.exports={transform:a}}),null);
__d("MercurySyncThreadNameTransformer",["MercuryActionType","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function(a,b,c,d,e,f){"use strict";function a(a,c){a=b("MercurySyncNewMessageTransformer").transform(a,c);a.action_type=b("MercuryActionType").LOG_MESSAGE;a.log_message_body=c.messageMetadata.adminText;a.log_message_data={name:c.name};a.log_message_type=b("MercuryLogMessageType").THREAD_NAME;return a}e.exports={transform:a}}),null);
__d("MercurySyncDispatcher",["MercuryDelayedDispatcher","MercuryGlobalActionType","MercuryPayloadSource","MercuryServerPayloadPreprocessor","MercurySyncThreadAdminsAddToGroupTransformer","MercurySyncThreadAdminsRemovedFromGroupTransformer","MercurySyncAdminTextMessageTransformer","MercurySyncClientPayloadTransformer","MercurySyncDeliveryReceiptTransformer","MercurySyncMarkFolderSeenTransformer","MercurySyncMarkReadTransformer","MercurySyncMarkUnreadTransformer","MercurySyncMessageDeleteTransformer","MercurySyncNewMessageTransformer","MercurySyncReadReceiptTransformer","MercurySyncPagesManagerEventTransformer","MercurySyncParticipantLeftGroupThreadTransformer","MercurySyncParticipantsAddedToGroupThreadTransformer","MercurySyncRTCEventLogTransformer","MercurySyncThreadDeleteTransformer","MercurySyncMarkFolderChangeTransformer","MercurySyncThreadMuteSettingsTransformer","MercurySyncThreadNameTransformer","MercurySyncThreadActionTransformer","MercurySyncReplaceMessageTransformer","MercurySyncThreadJoinableModeTransformer","MercurySyncThreadApprovalModeTransformer","MercurySyncThreadApprovalQueueTransformer","MercurySyncRtcCallDataTransformer","MercurySyncDeltaTypes","MercurySingletonProvider","MontageActions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="FOLDER_MONTAGE";a.getForFBID=function(a){return h.getForFBID(a)};a.get=function(){return h.get()};function a(a){this.$1=a,this.$2=b("MercuryDelayedDispatcher").getForFBID(this.$1),this.$3=b("MercuryServerPayloadPreprocessor").getForFBID(this.$1)}a.prototype.process=function(a){__p&&__p();var c;void 0;var d=void 0;switch(a["class"]){case b("MercurySyncDeltaTypes").NewMessage:c=b("MercurySyncNewMessageTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").ReplaceMessage:c=b("MercurySyncReplaceMessageTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").DeliveryReceipt:c=b("MercurySyncDeliveryReceiptTransformer").transform(a);this.$3.handleUpdate(c);break;case b("MercurySyncDeltaTypes").MarkRead:c=b("MercurySyncMarkReadTransformer").transform(a);var e=[],f=[];c.forEach(function(a){a.action_type===b("MercuryGlobalActionType").MARK_ALL_READ?e.push(a):f.push(a)});e.length&&this.$5(e);f.length&&this.$6(f);break;case b("MercurySyncDeltaTypes").MarkUnread:c=b("MercurySyncMarkUnreadTransformer").transform(a);this.$6(c);break;case b("MercurySyncDeltaTypes").ParticipantLeftGroupThread:c=b("MercurySyncParticipantLeftGroupThreadTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").ParticipantsAddedToGroupThread:c=b("MercurySyncParticipantsAddedToGroupThreadTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").RTCEventLog:c=b("MercurySyncRTCEventLogTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").ThreadName:c=b("MercurySyncThreadNameTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").ReadReceipt:c=b("MercurySyncReadReceiptTransformer").transform(a);this.$3.handleUpdate(c);break;case b("MercurySyncDeltaTypes").AdminTextMessage:c=b("MercurySyncAdminTextMessageTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").MessageDelete:d=a.threadKey.threadFbId;d&&a.folder&&a.folder===g?b("MontageActions").requestUpdate(d):(c=b("MercurySyncMessageDeleteTransformer").transform(a),this.$4(c));break;case b("MercurySyncDeltaTypes").ThreadAction:c=b("MercurySyncThreadActionTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").ThreadDelete:c=b("MercurySyncThreadDeleteTransformer").transform(a);this.$6(c);break;case b("MercurySyncDeltaTypes").AdminAddedToGroupThread:c=b("MercurySyncThreadAdminsAddToGroupTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").AdminRemovedFromGroupThread:c=b("MercurySyncThreadAdminsRemovedFromGroupTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").ThreadMuteSettings:c=b("MercurySyncThreadMuteSettingsTransformer").transform(a);this.$6([c]);break;case b("MercurySyncDeltaTypes").PagesManagerEvent:c=b("MercurySyncPagesManagerEventTransformer").transform(a);if(!c)return;this.$6([c]);break;case b("MercurySyncDeltaTypes").JoinableMode:c=b("MercurySyncThreadJoinableModeTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").ApprovalMode:c=b("MercurySyncThreadApprovalModeTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").ApprovalQueue:c=b("MercurySyncThreadApprovalQueueTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").ClientPayload:c=b("MercurySyncClientPayloadTransformer").transform(a,this.$1);if(!c)return;this.$4(c);break;case b("MercurySyncDeltaTypes").GenieMessage:c=b("MercurySyncNewMessageTransformer").transform(this.$1,a.deltaNewMessage);this.$4(c);break;case b("MercurySyncDeltaTypes").MontageMessage:d=a.newMessage.messageMetadata.actorFbId;d&&b("MontageActions").requestUpdate(d);break;case b("MercurySyncDeltaTypes").RtcCallData:c=b("MercurySyncRtcCallDataTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").MarkFolderSeen:c=b("MercurySyncMarkFolderSeenTransformer").transform(a);this.$5(c);break;case b("MercurySyncDeltaTypes").ThreadFolder:c=b("MercurySyncMarkFolderChangeTransformer").transform(a);this.$6([c]);break;default:break}};a.prototype.$4=function(a){var c=a.other_user_fbid||a.thread_fbid;this.$2.handleUpdateWaitForThread({actions:[a],payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE},c)};a.prototype.$5=function(a){this.$3.handleUpdate({global_actions:a,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE})};a.prototype.$6=function(a){this.$3.handleUpdate({actions:a,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE})};var h=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercurySyncDataFetcherImpl",["errorCode","Promise","AsyncResponse","Bootloader","CurrentUser","FBIDCheck","MercuryPayloadSource","MercuryThreadlistConstants","MessagingConfig","UserActivity","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();b("MessagingConfig").syncFetchRequestTimeoutMs;var h={limit:b("MercuryThreadlistConstants").WEBMESSENGER_THREAD_COUNT+1,folder:"inbox",tags:["INBOX"],timestamp:null,offset:b("MercuryThreadlistConstants").RECENT_THREAD_OFFSET,filter:null,includeDeliveryReceipts:!1,includeSeqID:!0},i={};function a(a){return new(b("Promise"))(function(b,c){j(a,b,c,0)})}function j(a,c,d,e){__p&&__p();if(!b("CurrentUser").isLoggedInNow()||e>b("MessagingConfig").syncFetchRetries){b("clearTimeout")(i[a]);d();return}var f=e===0?0:b("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(b("MessagingConfig").syncFetchTimeoutMultiplier,e);b("UserActivity").isOnTab()||(f+=500*Math.random());b("clearTimeout")(i[a]);i[a]=b("setTimeoutAcrossTransitions")(function(){__p&&__p();var f=!1,g=function(g){if(f)return;g.errors&&g.errors.length>0&&(function(){var c=g.errors[0].message;c&&b("Bootloader").loadModules(["MessengerWebGraphQLTypedLogger","MessengerWebGraphQLEvent"],function(b,d){new b().setErrorMessage(c).setEvent(d.DFF_FAILURE).setQueryParams(a).log()},"MercurySyncDataFetcherImpl")})();f=!0;j(a,c,d,e+1)};b("Bootloader").loadModules(["MessengerGraphQLThreadlistFetcher.bs"],function(d){return d.fetchAll(a,[h],!b("FBIDCheck").isUser_deprecated(a)).then(function(d){f=!0,c(new(b("AsyncResponse"))(null,babelHelpers["extends"]({},d,{payload_source:b("MercuryPayloadSource").SERVER_INVALIDATE_GLOBAL_STATE}))),b("clearTimeout")(i[a])},g)},"MercurySyncDataFetcherImpl")},f)}function c(a,c,d){return new(b("Promise"))(function(b,e){k(a,c,d,b,e,0)})}function k(a,c,d,e,f,g){__p&&__p();if(g>b("MessagingConfig").syncFetchRetries){f();return}var h=g===0?0:b("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(b("MessagingConfig").syncFetchTimeoutMultiplier,g);b("setTimeoutAcrossTransitions")(function(){var h=!1,i=function(b){if(h)return;h=!0;k(a,c,d,e,f,g+1)};b("Bootloader").loadModules(["MessengerThreadDFFFetcher.bs"],function(f){return f.fetch(a,{id:c,limit:d},!b("FBIDCheck").isUser_deprecated(a)).then(function(a){h=!0,e(new(b("AsyncResponse"))(null,babelHelpers["extends"]({},a,{payload_source:b("MercuryPayloadSource").SERVER_INVALIDATE_THREAD_STATE})))},i)},"MercurySyncDataFetcherImpl")},h)}function d(a,c,d){return new(b("Promise"))(function(b,e){l(a,c,d,b,e,0)})}function l(a,c,d,e,f,g){__p&&__p();if(g>b("MessagingConfig").syncFetchRetries){f();return}var h=g===0?0:b("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(b("MessagingConfig").syncFetchTimeoutMultiplier,g);b("setTimeoutAcrossTransitions")(function(){var h=!1,i=function(b){if(h)return;h=!0;l(a,c,d,e,f,g+1)};b("Bootloader").loadModules(["MessengerMessageDFFFetcher.bs"],function(f){return f.fetch(a,{thread_id:c,message_id:d},!b("FBIDCheck").isUser_deprecated(a)).then(function(a){h=!0,e(new(b("AsyncResponse"))(null,babelHelpers["extends"]({},a)))},i)},"MercurySyncDataFetcherImpl")},h)}e.exports={fetchThreadlistFromGraphQL:a,fetchThreadFromGraphQL:c,fetchMessageFromGraphQL:d}}),null);
__d("MercurySyncDataFetcher",["Promise","LogHistory","MessagingConfig","MercurySyncDataFetcherImpl","WebGraphQLConfig","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("LogHistory").getInstance("mercury_sync_data_fetcher");function a(){var a=0;for(var c=0;c<b("MessagingConfig").syncFetchRetries;c++){var d=c===0?0:b("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(b("MessagingConfig").syncFetchTimeoutMultiplier,c);a+=d+b("MessagingConfig").syncFetchRequestTimeoutMs}return a}var h=a();function c(a){var c=null;return new(b("Promise"))(function(d,e){var f=function(a){g.error("fetch_threadlist_graphql_timeout",JSON.stringify({timeout:h})),b("clearTimeout")(c),e(a)};c=b("setTimeoutAcrossTransitions")(f,Math.max(h,b("WebGraphQLConfig").timeout*b("MessagingConfig").syncFetchRetries));b("MercurySyncDataFetcherImpl").fetchThreadlistFromGraphQL(a).done(function(a){b("clearTimeout")(c),d(a)},f)})}function d(a,c,d){return new(b("Promise"))(function(e,f){var i=function(a){g.error("fetch_thread_graphql_timeout",JSON.stringify({timeout:h})),f(a)},j=b("setTimeoutAcrossTransitions")(i,h);b("MercurySyncDataFetcherImpl").fetchThreadFromGraphQL(a,c,d).done(function(a){b("clearTimeout")(j),e(a)},i)})}function f(a,c,d){return new(b("Promise"))(function(e,f){var i=function(a){g.error("fetch_message_graphql_timeout",JSON.stringify({timeout:h})),f(a)},j=b("setTimeoutAcrossTransitions")(i,h);b("MercurySyncDataFetcherImpl").fetchMessageFromGraphQL(a,c,d).done(function(a){b("clearTimeout")(j),e(a)},i)})}e.exports={fetchThreadlistFromGraphQL:c,fetchThreadFromGraphQL:d,fetchMessageFromGraphQL:f,getMaxTimeoutMs:a}}),null);
__d("MercurySyncDFFDataFetcher",["Promise","CurrentUser","MercuryMessages","MercuryThreads","MercuryThreadIDMap","MercurySingletonProvider","MercurySyncDataFetcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){this.$1=a,this.__messages=b("MercuryMessages").getForFBID(this.$1),this.__threads=b("MercuryThreads").getForFBID(this.$1),this.__threadIDMap=b("MercuryThreadIDMap").getForFBID(this.$1)}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};a.prototype.fetchInvalidateGlobalStateForGraphQL=function(){return this.$1&&this.$1!=="0"&&b("CurrentUser").isLoggedIn()?b("MercurySyncDataFetcher").fetchThreadlistFromGraphQL(this.$1):new(b("Promise"))(function(a,b){return b(!0)})};a.prototype.fetchInvalidateThreadState=function(a,c){var d=11,e=3;a=a||c;c=this.__threadIDMap.getClientIDFromServerIDNow(a);if(!c)return b("Promise").resolve({getPayload:function(){return{}}});e=e+this.__messages.getCurrentlyLoadedMessages(c).length;return!a?b("Promise").resolve({getPayload:function(){return{}}}):b("MercurySyncDataFetcher").fetchThreadFromGraphQL(this.$1,a,Math.max(e,d))};a.prototype.fetchInvalidateMessage=function(a,c,d){a=a||c;return!a?b("Promise").resolve({getPayload:function(){return{}}}):b("MercurySyncDataFetcher").fetchMessageFromGraphQL(this.$1,a,d)};var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercurySyncForcedFetchHandler",["Promise","MercurySingletonProvider","MercurySyncDFFDataFetcher","MercuryMessages","MercuryThreadIDMap"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){return{getPayload:function(){return{sequence_id:a}}}}a.getForFBID=function(a){return h.getForFBID(a)};a.get=function(){return h.get()};function a(a){this.$1=a,this.$2=b("MercuryMessages").getForFBID(this.$1),this.$3=b("MercuryThreadIDMap").getForFBID(this.$1),this.$4=b("MercurySyncDFFDataFetcher").getForFBID(this.$1)}a.prototype.processMessageDFF=function(a,c,d,e){__p&&__p();if(e){e=c.otherUserFbId!==undefined?c.otherUserFbId.toString():c.threadFbId.toString();e=this.$3.getClientIDFromServerIDNow(e);if(e===undefined)return b("Promise").resolve(g(a));e=this.$2.getMessagesFromIDs([d]);if(e.length===0)return b("Promise").resolve(g(a))}return this.$4.fetchInvalidateMessage(c.otherUserFbId,c.threadFbId,d)};a.prototype.processThreadDFF=function(a,c,d){if(d){d=c.otherUserFbId!==undefined?c.otherUserFbId.toString():c.threadFbId.toString();d=this.$3.getClientIDFromServerIDNow(d);if(d===undefined)return b("Promise").resolve(g(a))}return this.$4.fetchInvalidateThreadState(c.otherUserFbId,c.threadFbId)};a.prototype.processGlobalDFFForGraphQL=function(){return this.$4.fetchInvalidateGlobalStateForGraphQL()};var h=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercurySyncTopicType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({DELTA:"delta",DELTAFLOW:"deltaflow",DELTAFLOWREJECT:"deltaflowreject"})}),null);
__d("MercurySyncDeltaHandler",["invariant","Arbiter","AsyncResponse","ChannelConstants","ChatReliabilityInstrumentation","CurrentUser","FBIDCheck","LogHistory","MercuryConfig","MessagingConfig","MercuryDelayedDispatcher","MercuryPayloadSource","MercurySyncChannelMonitor","MercurySyncConstants","MercurySyncDeltaHolder","MercurySyncDeltaTypes","MercurySyncDispatcher","MercurySyncForcedFetchHandler","MercurySyncHolesTypedLogger","MercuryServerPayloadPreprocessor","MercurySyncTopicType","MercurySingletonProvider","gkx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("LogHistory").getInstance("mercury_sync_delta_handler"),i=b("MessagingConfig").syncFetchRetries||0;a.getForFBID=function(a){return j.getForFBID(a)};a.get=function(){return j.get()};function a(a){__p&&__p();this.$1=a,this.$2=b("MercurySyncDispatcher").getForFBID(this.$1),this.$3=b("MercurySyncForcedFetchHandler").getForFBID(this.$1),this.__payloadPreprocessor=b("MercuryServerPayloadPreprocessor").getForFBID(this.$1),this.__delayedDispatcher=b("MercuryDelayedDispatcher").getForFBID(this.$1),this.$4=b("MercurySyncDeltaHolder").getForFBID(this.$1),this.$5=!1,this.$11=b("MercurySyncChannelMonitor").getForFBID(this.$1),this.$6=[],this.$13=0,h.debug("constructor",JSON.stringify({fbid:this.$1})),b("Arbiter").subscribe("MercurySyncDeltaHandler/initSeqID",function(a,c){__p&&__p();h.debug("initSeqID",JSON.stringify(c));a=c&&c.seqID;c=c&&c.fbid;if(!c)return;if(c!==this.$1)return;a?this.$4.updateLastSeqID(a):this.$4.updateLastSeqID(0);this.$15();this.$8=b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("deltaflow"),function(a,b){this.$14||this.$15()}.bind(this))}.bind(this))}a.prototype.$15=function(){__p&&__p();h.debug("setUpSubscriptionsToRealTimeUpdates",JSON.stringify({fbid:this.$1})),this.$7=b("Arbiter").subscribe(this.$16(),function(a,c){__p&&__p();a=c&&c.obj&&c.obj.queue;if(a&&a.toString()!==this.$1)return;a=c&&c.obj&&c.obj.delta;c=c&&c.obj&&c.obj.iseq;if(!a||!c)return;this.$17(c,b("MercurySyncTopicType").DELTA);this.$18(c,a);this.$4.push(c,a);this.$19()}.bind(this)),this.$12=b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("deltaflowreject"),function(a,b){a=b&&b.obj&&b.obj.queue;if(a&&a.toString()!==this.$1)return;this.$14&&this.$20()}.bind(this)),this.$9=b("Arbiter").subscribe(b("ChannelConstants").getArbiterType(b("ChannelConstants").FAKE_DFF),function(a,b){a=b&&b.obj&&b.obj.queue;if(a&&a.toString()!==this.$1)return;a=b&&b.obj&&b.obj.delta;if(!a)return;this.$6.push(a);this.$19()}.bind(this)),this.$11.setupSubscriptions(),this.$14=!0};a.prototype.$19=function(){__p&&__p();if(this.$5)return;if(this.$6.length>0){var a=this.$6.shift();this.$21(this.$4.getLastSeqID(),a);this.$19()}a=this.$4.peek();if(!a)return;a=a-this.$4.getLastSeqID();if(a===1){var b=this.$4.pop();if(!b)return;var c=b.seqID;b=b.delta;this.$21(c,b);this.$19()}else a>1?this.$22():(this.$4.pop(),this.$19())};a.prototype.$21=function(a,c){this.$4.updateLastSeqID(a),c["class"]===b("MercurySyncDeltaTypes").ForcedFetch?(h.debug("DFF",JSON.stringify(c)),c.threadKey!==undefined&&c.messageId===undefined?this.$23(a,c):c.threadKey!==undefined&&c.messageId!==undefined?this.$24(a,c):(b("ChatReliabilityInstrumentation").logDFF_DELTA_INIT(JSON.stringify(c)),this.$25(a))):this.$2.process(c)};a.prototype.$22=function(){var a=JSON.stringify({$26:this.$4.getLastSeqID(),nextSeqID:this.$4.peek()});h.warn("hole",a);var c=this.$4.peek();!c&&g(0);c=c-1;b("ChatReliabilityInstrumentation").logDFF_HOLE_INIT(a);this.$25(c)};a.prototype.$27=function(a,b,c,d){this.$5&&g(0),this.$5=!0,h.debug("_scheduleDataFetch:start",JSON.stringify({seqID:a})),b().done(function(b){h.debug("_scheduleDataFetch:success",JSON.stringify({seqID:a})),c(a,b),this.$5=!1,this.$19()}.bind(this),function(b){h.error("_scheduleDataFetch:failure",JSON.stringify({seqID:a})),d(a,b),this.$5=!1,this.$19()}.bind(this))};a.prototype.$25=function(a){__p&&__p();if(!b("CurrentUser").isLoggedInNow())return;this.$27(undefined,function(){return this.$3.processGlobalDFFForGraphQL()}.bind(this),function(a,c){a=c.getPayload();this.__payloadPreprocessor.handleUpdate(a);a.sequence_id&&(h.debug("_initiateGlobalDFF:success",JSON.stringify({seqID:a.sequence_id})),this.$4.updateLastSeqID(a.sequence_id));this.$13=0;b("Arbiter").inform(b("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE_RECOVER)}.bind(this),function(c,d){h.error("_initiateGlobalDFF:failure",""),this.$13>=i&&!b("gkx")("AT6272W7G37c2zZOpPDUPGXaehXUPvo7_ZqAqdSAoKzgP5DQ8Luz0w5hQkLZeaPa8UmuuAXTSUI8FctXnbHnbKTw")||d?(this.$14&&this.$20(),b("gkx")("AT6T2zrYpHKRdiC2jWw79jSLuG2Ai8UAXBl4mf7UaSrzuZmkv1aboo5IByEaBzwrmKZ7i_TneQib5Fe9fVTNdQMv")&&this.$4.updateLastSeqID(a)):(this.$13++,b("Arbiter").inform(b("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE_RETRY),h.debug("_initiateGlobalDFF:retry",""),this.$5=!1,this.$25(a))}.bind(this))};a.prototype.$23=function(a,b){this.$27(a,function(){return this.$3.processThreadDFF(a,b.threadKey,b.isLazy)}.bind(this),function(a,b){this.__payloadPreprocessor.handleUpdate(b.getPayload()),this.$4.updateLastSeqID(a)}.bind(this),function(){h.error("_initiateThreadDFF:failure",JSON.stringify(b));var c=babelHelpers["extends"]({},b);delete c.threadKey;this.$4.updateLastSeqID(a-1);this.$4.push(a,c)}.bind(this))};a.prototype.$24=function(a,c){__p&&__p();this.$27(a,function(){return this.$3.processMessageDFF(a,c.threadKey,c.messageId,c.isLazy)}.bind(this),function(a,c){c=c.getPayload();var d=c.other_user_fbid?c.other_user_fbid:c.thread_fbid;c=[babelHelpers["extends"]({},c)];var e=b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE;this.__delayedDispatcher.handleUpdateWaitForThread({actions:c,payload_source:e},d);this.$4.updateLastSeqID(a)}.bind(this),function(){h.error("_initiateMessageDFF:failure",JSON.stringify(c));var b=babelHelpers["extends"]({},c);delete b.messageId;this.$4.updateLastSeqID(a-1);this.$4.push(a,b)}.bind(this))};a.prototype.$17=function(a,c){var d=a-this.$4.getLastSeqID();if(d!==1&&d!==0){if(!b("MercuryConfig").WWWSyncHolesLogging)return;new(b("MercurySyncHolesTypedLogger"))().setSeqID(a).setDifference(d).setTopicType(c).log()}};a.prototype.$18=function(a,c){switch(c["class"]){case b("MercurySyncDeltaTypes").NewMessage:h.debug("message_delta",JSON.stringify({seqID:a,threadKey:c.messageMetadata.threadKey,messageId:c.messageMetadata.messageId}));break;case b("MercurySyncDeltaTypes").ReadReceipt:h.debug("read_receipt_delta",JSON.stringify({seqID:a,threadKey:c.threadKey,actionTimestampMs:c.actionTimestampMs,watermarkTimestampMs:c.watermarkTimestampMs}));break;case b("MercurySyncDeltaTypes").DeliveryReceipt:h.debug("delivery_receipt_delta",JSON.stringify({seqID:a,deliveredWatermarkTimestampMs:c.deliveredWatermarkTimestampMs,messageIds:c.messageIds}));break}};a.prototype.$20=function(){this.$14=!1,b("Arbiter").unsubscribe(this.$7),b("Arbiter").unsubscribe(this.$9),b("Arbiter").unsubscribe(this.$12),this.$11.killSubscriptions(),b("Arbiter").inform(b("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE)};a.prototype.$16=function(){return b("gkx")("AT4L8DlAE0WEKOKYkeJWzHDsRi3-ZWFYr4agMbkLtMUBERlxiBLblqdrc15ka2y0CqeZkLHc9yfq9QS1H3akL6e9")?"messenger-mqtt-delta":b("ChannelConstants").getArbiterType("delta")};var j=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercurySyncEnvironment",["Arbiter","ChannelInitialData","CurrentUser","MercurySyncDeltaHandler"],(function(a,b,c,d,e,f){"use strict";function a(){if(!b("ChannelInitialData").channelConfig)return;b("MercurySyncDeltaHandler").get();b("Arbiter").inform("MercurySyncDeltaHandler/initSeqID",{fbid:b("CurrentUser").getAccountID(),seqID:b("ChannelInitialData").channelConfig.sequenceId})}e.exports={setUp:a}}),null);
__d("MercuryUnseenState",["MessageThreadReadStateEffect","MercuryFolders","KeyedCallbackManager","LogHistory","MercuryActionType","MercuryDispatcher","MercuryGlobalActionType","MercurySingletonProvider","MercuryThreadIDMap","MercuryThreadInfo","MercuryThreadlistConstants","MessagingTag","MercuryServerRequests","MercuryThreadInformer","MercuryThreads","createObjectFrom","isEmpty"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MessageThreadReadStateEffect").MessageThreadReadStateEffectType,h=b("MercuryThreadlistConstants").MAX_UNSEEN_COUNT,i="unseen_thread_hash",j="unseen_thread_list",k=b("LogHistory").getInstance("mercury_unseen_state");a.getForFBID=function(a){return l.getForFBID(a)};a.get=function(){return l.get()};function a(a){this.$2=a,this.$7=b("MercuryServerRequests").getForFBID(this.$2),this.$8=b("MercuryThreadIDMap").getForFBID(this.$2),this.$10=b("MercuryThreads").getForFBID(this.$2),this.$9=b("MercuryThreadInformer").getForFBID(this.$2),this.$1=b("MercuryDispatcher").getForFBID(this.$2),this.$3=0,this.$4=0,this.$5=!1,this.$6=!1,this.$11=new(b("KeyedCallbackManager"))(),this.$1.subscribe("update-unseen",function(a,b){this.$12(b)}.bind(this)),this.$1.subscribe("update-thread-ids",function(a,b){this.$13(b)}.bind(this))}a.prototype.getUnseenCount=function(){if(this.exceedsMaxCount()){k.error("unguarded_unseen_count_fetch","{}");return 0}return this.$14()};a.prototype.exceedsMaxCount=function(){return this.$5||this.$14()>h};a.prototype.markAsSeen=function(){var a=this.$14();a===null?this.$6=!0:(a>0||this.$5)&&(this.$7.markSeen(),this.$15(this.$7.getLastActionTimestamp(),[]))};a.prototype.$16=function(a,b){var c;this.$17((c={},c[a]=0,c),b)};a.prototype.$18=function(a){this.$11.setResource(i,a),this.$11.setResource(j,Object.keys(a))};a.prototype.$19=function(a){a=this.$11.executeOrEnqueue(i,a);a=this.$11.getUnavailableResources(a);a.length&&this.$7.fetchUnseenThreadIDs()};a.prototype.$20=function(){return this.$11.getResource(i)};a.prototype.$14=function(){var a=this.$11.getResource(j);if(a)return a.length;else return this.$3};a.prototype.$12=function(a){__p&&__p();var c,d=this,e=this.$21(a);if(a.unseen_thread_fbids)a.unseen_thread_fbids.forEach(function(a){if(a.folder!=b("MessagingTag").INBOX)return;a=(a.thread_fbids||[]).concat(a.other_user_fbids||[]);a=this.$22(a);var c=e.seen_timestamp?e.seen_timestamp:this.$4;this.$15(c,a);e.unseen_count>h&&(this.$5=!0)}.bind(this));else if(e.seen_timestamp!==undefined)this.$4=e.seen_timestamp,e.unseen_count>h?(this.$5=!0,this.$18({})):(this.$3=e.unseen_count,this.$3===0&&this.$18({}));else{var c=function(){__p&&__p();var c;(a.global_actions||[]).forEach(function(a){a.action_type===b("MercuryGlobalActionType").MARK_ALL_SEEN&&this.$15(a.timestamp,[])}.bind(d));if(d.$5)return{v:void 0};var e=a.actions;if(!e||!e.length)return{v:void 0};var f={},h={},i=function(a){__p&&__p();var c=e[a];a=c.action_type;var i=c.other_user_fbid?c.other_user_fbid:c.thread_fbid,j=c.thread_id?c.thread_id:i;if(a===b("MercuryActionType").MARK_THREAD_SEEN){d.$16(j,c.persistent);return"continue"}if(!d.$23(c))return"continue";if(c.thread_read_state_effect&&c.thread_read_state_effect!==g.MARK_UNREAD)return"continue";if(a===b("MercuryActionType").USER_GENERATED_MESSAGE||a===b("MercuryActionType").LOG_MESSAGE){i=f[j]?c.timestamp>f[j]:!1;i=i||!f[j];c.is_unread&&i&&d.$10.getThreadMeta(j,function(a){!b("MercuryThreadInfo").isMuted(a)&&!(a&&a.last_read_timestamp>=c.timestamp)&&(f[j]=c.timestamp)})}else a===b("MercuryActionType").CHANGE_READ_STATUS&&c.mark_as_read&&(h[j]=c.timestamp)};for(var j=0;j<e.length;j++){var c=i(j);if(c==="continue")continue}d.$24(f);d.$17(h)}();if(typeof c==="object")return c.v}this.$6&&(this.$6=!1,this.markAsSeen())};a.prototype.$15=function(a,c){__p&&__p();var d=this.$20();if(d===undefined||a>this.$4||this.$5){this.$4=a;c=c||[];c.length<=h&&(this.$5=!1);d={};a=this.$20();for(var e in a)if(a[e]!==!0){var f=a[e];this.$25(f)&&(d[e]=f)}f=Object.assign(b("createObjectFrom")(c,!0),d);this.$18(f);this.$9.updatedUnseenState()}};a.prototype.$24=function(a){__p&&__p();if(this.$5)return;var b={},c=!1;for(var d in a){var e=a[d];this.$25(e)&&(b[d]=e,c=!0)}if(!c)return;this.$19(function(a){for(var c in b){var d=b[c];!a[c]&&this.$25(d)&&(a[c]=b[c])}this.$18(a);this.$9.updatedUnseenState()}.bind(this))};a.prototype.$17=function(a,c){b("isEmpty")(a)||this.$19(function(b){var d=!1;for(var e in a){var f=a[e],g=f>=b[e];b[e]&&(!f||g)&&(delete b[e],d=!0)}d&&(this.$18(b),this.$9.updatedUnseenState(),c&&this.$14()===0&&this.$7.markSeen())}.bind(this))};a.prototype.$25=function(a){return a>this.$4};a.prototype.$22=function(a){return a.map(this.$8.convertThreadIDIfAvailable,this.$8)};a.prototype.$13=function(a){var b=this.$20();if(!b)return;for(var c in a){var d=a[c];b[c]&&(b[d]=b[c],delete b[c])}this.$18(b)};a.prototype.$23=function(a){var c=a.thread_id?this.$10.getThreadMetaNow(a.thread_id):null;c=c?b("MercuryFolders").getFromMeta(c):a.folder;return c===b("MessagingTag").INBOX||c===undefined};a.prototype.$21=function(a){a=a.message_counts||[];for(var c=0;c<a.length;c++)if(a[c].folder===b("MessagingTag").INBOX)return a[c];return{}};var l=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("P2PSendMoneyDialogStore",["P2PActionConstants","EventEmitter","P2PDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=36;void 0;var i=void 0;c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(){g.constructor.call(this),i=new Map(),b("P2PDispatcher").register(this.onEventDispatched.bind(this))}a.prototype.onEventDispatched=function(a){var c=a.data;a=a.type;switch(a){case b("P2PActionConstants").CHAT_SEND_VIEW_OPENED:this.handleChatSendViewOpened(c);this.emit("change");break;case b("P2PActionConstants").CHAT_SEND_VIEW_CLOSED:this.handleChatSendViewClosed(c);this.emit("change");break}};a.prototype.getStateByThreadID=function(a){return i.get(a)};a.prototype.handleChatSendViewOpened=function(a){i.set(a.threadID,{amount:a.amount,groupSendRecipientUserIDs:a.groupSendRecipientUserIDs,groupSendReceiptDetails:a.groupSendReceiptDetails,groupThreadFBID:a.groupThreadFBID,onCompletion:a.onCompletion,openRequestTab:a.openRequestTab,memoText:a.memoText&&a.memoText.substr(0,h),platformData:a.platformData,referrer:a.referrer,paymentRequestID:a.paymentRequestID,sendMoneyDialogShown:!0,sendMoneyNUXDismissed:a.sendMoneyNUXDismissed,useModal:a.useModal})};a.prototype.handleChatSendViewClosed=function(a){i.set(a.threadID,{amount:"",groupSendRecipientUserIDs:[],groupSendReceiptDetails:null,groupThreadFBID:"",onCompletion:null,openRequestTab:!1,memoText:null,platformData:null,referrer:null,paymentRequestID:null,sendMoneyDialogShown:!1,sendMoneyNUXDismissed:!1,useModal:!1})};a.prototype.isAnyChatSendViewOpen=function(){__p&&__p();for(var a=i.values(),b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;if(d.sendMoneyDialogShown)return!0}return!1};e.exports=new a()}),null);
__d("FantaTabsAppBase",["Bootloader","ChatAppActions","ChatAppStore","ChatPerfInstrumentation","CSS","JSLogger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a.prototype.init=function(a,c,d){__p&&__p();if(this.isInitialized()){b("JSLogger").create("chat_app").error("repeated_init");return}this.$1=a;this.tabsElem=c;var e=b("ChatAppStore").addListener(function(){var a=b("ChatAppStore").getPreviousState(),c=b("ChatAppStore").getState();a.initialDisplayDone===!1&&c.initialDisplayDone===!0&&(b("ChatPerfInstrumentation").logDisplayDone(),e.remove())});b("ChatPerfInstrumentation").init();this.$2(d);this.initializeFantaData(d.interstitial_data);this.initializeFantaUI();this.$3();b("ChatAppActions").tti();b("ChatPerfInstrumentation").logTTI()};a.prototype.isInitialized=function(){return!!b("ChatAppStore").getState().isInitialized};a.prototype.isHidden=function(){var a=b("ChatAppStore").getState();return!!(!a.isInitialized||a.isHidden)};a.prototype.hide=function(){if(this.isHidden())return;b("CSS").hide(this.$1);b("ChatAppActions").hide()};a.prototype.unhide=function(){var a=b("ChatAppStore").getState();a.isInitialized?a.isHidden&&(b("CSS").show(this.$1),d(["Dock"],function(a){a.resizeAllFlyouts()}),b("ChatAppActions").unhide()):a.isLoaded||(d(["UIPagelet"],function(a){a.loadFromEndpoint("ChatTabsPagelet","ChatTabsPagelet"),a.loadFromEndpoint("BuddylistPagelet","BuddylistPagelet")}),b("ChatAppActions").load())};a.prototype.initializeFantaData=function(a){};a.prototype.initializeFantaUI=function(){};a.prototype.$2=function(a){d(["MercuryDeliveryState","MercuryParticipants","MercuryServerPayloadPreprocessor","MercuryThreads","MercuryUnreadState","MercuryUnseenState","MercurySyncEnvironment","P2PSendMoneyDialogStore"],function(c,d,e,f,g,h,i,j){c.get(),d,f.get(),h.get(),g.get(),i.setUp(),b("ChatPerfInstrumentation").logInitStores(),a.graphql_payload?b("Bootloader").loadModules(["ChatInitialDataTransformer.bs"],function(b){var c=a.graphql_payload;b=b.transform(c);b.message_blocked_ids=c.message_blocked_ids;b.message_ignored_ids=c.message_ignored_ids;b.payload_source=c.payload_source;e.get().handleUpdate(b)},"FantaTabsAppBase"):e.get().handleUpdate(a.initial_data)})};a.prototype.$3=function(){d(["HotLikeSound","ChatOptions"],function(a,c){a.setCheckSoundEnabledFunc(function(){return c.getSetting("sound")}),b("ChatPerfInstrumentation").logInitSound()})};function a(){}e.exports=a}),null);
__d("FBRTCLocalMessageQueue",["CacheStorage","FBRTCConsoleLogger"],(function(a,b,c,d,e,f){__p&&__p();var g="localstorage",h="RTC_",i="offer",j="offer_msg",k="data_",l=30*1e3,m=15*1e3,n=500,o=new Map();function a(){"use strict";this.$1=b("FBRTCConsoleLogger").getInstance()}a.prototype.enqueueOffer=function(a,b){"use strict";a=this.$2(a,j);this.$3(a,i,b)};a.prototype.getOffer=function(a){"use strict";a=this.$2(a,j);return this.$4(a,i)};a.prototype.removeOffer=function(a){"use strict";a=this.$2(a,j);a.remove(i)};a.prototype.enqueueMessage=function(a,b,c,d){"use strict";b=k+c.toString();c=o.get(a)||new Map();c.set(b,d);o.set(a,c);this.$1.log("Queued "+b)};a.prototype.drainQueue=function(a,b){"use strict";__p&&__p();var c=o.get(a)||new Map(),d;void 0;void 0;for(var c=c,e=Array.isArray(c),f=0,c=e?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=c.length)break;g=c[f++]}else{f=c.next();if(f.done)break;g=f.value}g=g;var d=g[0];g=g[1];void d;b(g)}o.set(a,new Map())};a.prototype.enableDequeuing=function(a,b,c,d){"use strict";d===undefined&&(d=m),this.$5(a,b,c,d)};a.prototype.$5=function(a,b,c,d){"use strict";var e=this.$2(a,b),f=e.keys(),g=f.length;for(var h=0;h<g;h++){var i=this.$6(e,f[h]);i&&c&&c(i)}this.$1.log("Dequeued "+g+" ("+a+") with "+d+" left)");d>0&&(d-=n,setTimeout(function(){this.$5(a,b,c,d)}.bind(this),n))};a.prototype.$3=function(a,b,c){"use strict";c={__t:Date.now(),__d:c};a.set(b,c)};a.prototype.$4=function(a,b){"use strict";var c=a.get(b);if(c&&this.$7(c))return c.__d;else c&&a.remove(b);return null};a.prototype.$6=function(a,b){"use strict";var c=this.$4(a,b);if(c!==null){a.remove(b);return c}return null};a.prototype.$7=function(a){"use strict";return Date.now()-a.__t<l};a.prototype.$2=function(a,c){"use strict";return new(b("CacheStorage"))(g,""+h+a+"_"+c+"_")};e.exports=a}),null);
__d("FBRTCMessageListener",["invariant","Arbiter","BonfireFeatureGating","ChannelConstants","FBRTCCallControlActions","FBRTCConstants","FBRTCLocalMessageQueue","FBRTCSupport","RTCConfig","guid","mixInEventEmitter"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("FBRTCConstants").ChildWindowMessageType,i=45*1e3,j=[],k=null,l=null,m=null,n=null,o=null,p=!1,q=null,r=null,s=void 0;a={init:function(a,c){__p&&__p();if(p)return;p=!0;b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("webrtc"),function(a,b){this._onMessage(b.obj)}.bind(this));b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("webrtc_offer"),function(a,b){this._onMessage(b.obj)}.bind(this));b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("webrtc_offerack"),function(a,b){this._onMessage(b.obj)}.bind(this));b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("rtc_multi_json"),function(a,b){this._onMultiwayMessage(b.obj)}.bind(this));b("BonfireFeatureGating").canReceiveBonfireRingInterop()&&b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("parties_notifications"),function(a,b){this._onBonfireMessage(b.obj)}.bind(this));this._localMessageQueue=new(b("FBRTCLocalMessageQueue"))();if(b("RTCConfig").PassMessagesBetweenWindowsGK){if(b("FBRTCSupport").isWebrtcSupported()&&window.addEventListener){var d=a?this._handleWindowMessageToChild.bind(this):this._handleWindowMessageToParent.bind(this);window.addEventListener("message",d,!1)}a&&this._connectToParentWindow(c)}},setParentWindowNonce:function(a){n=a},generateNewNonce:function(){o=b("guid")();return o},setMultiwayMessageHandler:function(a,b){q&&g(0),q=b?a.bind(b):a},_onMultiwayMessage:function(a){this.emit("multiwayMessageReceived",a),q&&q(a)},setBonfireMessageHandler:function(a,b){r&&g(0),r=b?a.bind(b):a},_onBonfireMessage:function(a){this.emit("bonfireMessageReceived",a),r&&r(a)},setMessageHandler:function(a,b){k&&g(0);k=b?a.bind(b):a;while(j.length)k(j.shift())},removeMessageHandler:function(){k=null},setParentWindowStartCallHandler:function(a){s=a;return function(){return s=null}},_onMessage:function(a){a.from&&(a.from=a.from.toString()),this.emit("messageReceived",a),k?k(a):j.push(a),this._passMessageToChildWindow(a)},_connectToParentWindow:function(a){if(window.opener&&window.opener.postMessage){a={type:h.CHILD_WINDOW_READY,nonce:n,childNonce:this.generateNewNonce(),peerID:a};window.opener.postMessage(a,window.location.origin)}},_verifyWindowMessage:function(event){return event.origin===window.location.origin&&event.data&&o&&event.data.nonce===o},_handleWindowMessageToParent:function(event){if(!this._verifyWindowMessage(event))return;event.data.type===h.CHILD_WINDOW_READY&&(this.setParentWindowNonce(event.data.childNonce),this._setChildWindow(event.source),this._replayQueuedMessagesToChild(event.data.peerID,l))},_handleWindowMessageToChild:function(event){if(!this._verifyWindowMessage(event))return;event.data.type===h.CHILD_WINDOW_MESSAGE&&this._onMessage(event.data.message);event.data.type===h.CHILD_WINDOW_START_CALL&&(s?s():b("FBRTCCallControlActions").parentWindowStartCall())},_replayQueuedMessagesToChild:function(a,b){this._localMessageQueue.drainQueue(a,function(a){a={type:h.CHILD_WINDOW_MESSAGE,nonce:n,message:a};b.postMessage(a,window.location.origin)})},_setChildWindow:function(a){l=a,clearTimeout(m),m=setTimeout(function(){l=null},i),this._startCallInChildWindow(),this.generateNewNonce()},_passMessageToChildWindow:function(a){if(l){a={type:h.CHILD_WINDOW_MESSAGE,nonce:n,message:a};l.postMessage(a,window.location.origin)}},_startCallInChildWindow:function(){if(l){var a={type:h.CHILD_WINDOW_START_CALL,nonce:n};l.postMessage(a,window.location.origin)}}};b("mixInEventEmitter")(a,{messageReceived:!0,multiwayMessageReceived:!0,bonfireMessageReceived:!0});e.exports=a}),null);
__d("FBRTCMessageHandler",["Bootloader","FBRTCMessageListener","FBRTCSupport"],(function(a,b,c,d,e,f){__p&&__p();var g=null,h=!1,i=null,j=null;a={init:function(){!h&&b("FBRTCSupport").isReceiveWebrtcSupported()&&(h=!0,b("FBRTCMessageListener").init(!1),b("FBRTCMessageListener").once("messageReceived",function(a){k()}),b("FBRTCMessageListener").once("multiwayMessageReceived",function(a){l(a)}),b("FBRTCMessageListener").once("bonfireMessageReceived",function(a){m(a)}))}};function k(){g||b("Bootloader").loadModules(["FBRTCIncomingCallController","FBRTCIncomingCallDialog","FBRTCMissedVideoCallHandler","FBRTCUnsupportedBrowserMessage"],function(a,c,d,e){g=new a(c,e,new d()),b("FBRTCMessageListener").setMessageHandler(g.onMessageReceived,g)},"FBRTCMessageHandler")}function l(a){i||b("Bootloader").loadModules(["FBRTCGroupCallIncomingController","FBRTCGroupCallIncomingDialog"],function(c,d){i=new c(d,!0),b("FBRTCMessageListener").setMultiwayMessageHandler(i.onMessageReceived,i),i.onMessageReceived(a)},"FBRTCMessageHandler")}function m(a){j||b("Bootloader").loadModules(["FBRTCGroupCallIncomingController","FBRTCGroupCallIncomingDialog"],function(c,d){j=new c(d),b("FBRTCMessageListener").setBonfireMessageHandler(j.onBonfireMessageReceived,j),j.onBonfireMessageReceived(a)},"FBRTCMessageHandler")}e.exports=a}),null);
__d("FantaTabsSlimApp",["BootloadOnRender.react","ChatPerfInstrumentation","FantaTabMainPlaceholder.react","FantaTabsAppBase","JSResource","LazyComponent.react","React","ReactDOM","WorkplaceChatHelper","emptyFunction","ifRequired","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=void 0;c=babelHelpers.inherits(a,b("FantaTabsAppBase"));g=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$FantaTabsSlimApp1=!1,this.$FantaTabsSlimApp3=function(a,c){this.$FantaTabsSlimApp1?b("ifRequired")("FantaMessageActions",function(d){b("setImmediate")(function(){d.receivedNewMessage(a,c)})}):this.$FantaTabsSlimApp2(function(){b("ifRequired")("FantaMessageActions",function(d){b("setImmediate")(function(){d.receivedNewMessage(a,c)})})})}.bind(this),c}a.prototype.getPumpedUp=function(a){this.$FantaTabsSlimApp1?a():this.$FantaTabsSlimApp2(a)};a.prototype.silentPumpUp=function(){this.$FantaTabsSlimApp1||this.$FantaTabsSlimApp2(b("emptyFunction"),!0)};a.prototype.getViewComponent=function(a){a=a?b("React").createElement("div",null):b("React").createElement(b("FantaTabMainPlaceholder.react"),null);return b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{loadDataOnMount:!1}),loader:b("JSResource")("FantaMercuryTabsWithMain.react").__setRef("FantaTabsSlimApp"),placeholder:a})};a.prototype.initializeFantaData=function(a){__p&&__p();d(["FantaCookieUtil","MercuryThreadInformer","PresenceState"],function(c,d,e){__p&&__p();b("WorkplaceChatHelper").suppressChatIfActiveOnDesktop()||(e.registerStateLoader(function(d){var e=this;this.$FantaTabsSlimApp1?b("ifRequired")("FantaTabActions",function(e){b("ifRequired")("FantaAppStore",function(b){e.loadFromData(c.convertCookieData(d,b.getState().tabGroup,a))})}):(function(){var f=c.convertCookieData(d,null,a);f&&f.tabs.length>0&&e.$FantaTabsSlimApp2(function(){b("ifRequired")("FantaTabActions",function(a){a.loadFromData(f)})})})()}.bind(this)),e.doSync()),d.get().subscribe("threads-updated",function(a,c){b("ifRequired")("FantaGetMessageActions",function(a){Object.keys(c).forEach(function(c){b("setImmediate")(function(){a.refreshThread(c)})})})}),b("ChatPerfInstrumentation").logInitData()}.bind(this))};a.prototype.$FantaTabsSlimApp2=function(a,c){__p&&__p();b("ifRequired")("FantaAppStore",function(b){a()},function(){d(["FantaAppStore","FantaCookieUtil","FantaMessageActions","FantaTabActions","FantaTabViewportManager","PresenceState"],function(d,e,f,g,i,j){j.registerStateStorer(function(a){var b=d.getState().tabGroup;if(!h||h&&!h.equals(b)){h=b;return e.createCookieData(b,a)}else return a}),b("ReactDOM").render(this.getViewComponent(c),this.tabsElem),i.init(this.tabsElem),this.$FantaTabsSlimApp1=!0,a()}.bind(this))}.bind(this))};a.prototype.initializeFantaUI=function(){d(["FantaMercuryThreadEventsBootloaded","FantaMessageActions","FantaTabActions","FantaTabViewportManager","FBRTCMessageHandler","MercuryBrowserAlerts"],function(a,c,d,e,f,g){f.init(),g.init(),a.onMessagesReceived(this.$FantaTabsSlimApp3),b("ChatPerfInstrumentation").logInitUI(),b("ChatPerfInstrumentation").logDisplayDone()}.bind(this))};e.exports=new a()}),null);
__d("MercuryTriodeSourceUtil",["MessengerEnvironment","MercurySourceType"],(function(a,b,c,d,e,f){"use strict";a={getMercuryTriodeSource:function(){return b("MessengerEnvironment").messengerdotcom?b("MercurySourceType").MESSENGER_WEB:b("MercurySourceType").TITAN_WEB}};e.exports=a}),null);